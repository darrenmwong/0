window.Modernizr=function(t,e,i){function n(t){v.cssText=t}function s(t,e){return n(x.join(t+";")+(e||""))}function r(t,e){return typeof t===e}function o(t,e){return!!~(""+t).indexOf(e)}function a(t,e){for(var n in t){var s=t[n];if(!o(s,"-")&&v[s]!==i)return"pfx"==e?s:!0}return!1}function h(t,e,n){for(var s in t){var o=e[t[s]];if(o!==i)return n===!1?t[s]:r(o,"function")?o.bind(n||e):o}return!1}function c(t,e,i){var n=t.charAt(0).toUpperCase()+t.slice(1),s=(t+" "+w.join(n+" ")+n).split(" ");return r(e,"string")||r(e,"undefined")?a(s,e):(s=(t+" "+E.join(n+" ")+n).split(" "),h(s,e,i))}function u(){f.input=function(i){for(var n=0,s=i.length;s>n;n++)N[i[n]]=!!(i[n]in O);return N.list&&(N.list=!(!e.createElement("datalist")||!t.HTMLDataListElement)),N}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),f.inputtypes=function(t){for(var n,s,r,o=0,a=t.length;a>o;o++)O.setAttribute("type",s=t[o]),n="text"!==O.type,n&&(O.value=b,O.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(s)&&O.style.WebkitAppearance!==i?(_.appendChild(O),r=e.defaultView,n=r.getComputedStyle&&"textfield"!==r.getComputedStyle(O,null).WebkitAppearance&&0!==O.offsetHeight,_.removeChild(O)):/^(search|tel)$/.test(s)||(n=/^(url|email)$/.test(s)?O.checkValidity&&O.checkValidity()===!1:O.value!=b)),P[t[o]]=!!n;return P}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var p,l,d="2.8.3",f={},g=!0,_=e.documentElement,m="modernizr",y=e.createElement(m),v=y.style,O=e.createElement("input"),b=":)",S={}.toString,x=" -webkit- -moz- -o- -ms- ".split(" "),z="Webkit Moz O ms",w=z.split(" "),E=z.toLowerCase().split(" "),T={svg:"http://www.w3.org/2000/svg"},M={},P={},N={},C=[],F=C.slice,D=function(t,i,n,s){var r,o,a,h,c=e.createElement("div"),u=e.body,p=u||e.createElement("body");if(parseInt(n,10))for(;n--;)a=e.createElement("div"),a.id=s?s[n]:m+(n+1),c.appendChild(a);return r=["&#173;",'<style id="s',m,'">',t,"</style>"].join(""),c.id=m,(u?c:p).innerHTML+=r,p.appendChild(c),u||(p.style.background="",p.style.overflow="hidden",h=_.style.overflow,_.style.overflow="hidden",_.appendChild(p)),o=i(c,t),u?c.parentNode.removeChild(c):(p.parentNode.removeChild(p),_.style.overflow=h),!!o},I=function(e){var i=t.matchMedia||t.msMatchMedia;if(i)return i(e)&&i(e).matches||!1;var n;return D("@media "+e+" { #"+m+" { position: absolute; } }",function(e){n="absolute"==(t.getComputedStyle?getComputedStyle(e,null):e.currentStyle).position}),n},k=function(){function t(t,s){s=s||e.createElement(n[t]||"div"),t="on"+t;var o=t in s;return o||(s.setAttribute||(s=e.createElement("div")),s.setAttribute&&s.removeAttribute&&(s.setAttribute(t,""),o=r(s[t],"function"),r(s[t],"undefined")||(s[t]=i),s.removeAttribute(t))),s=null,o}var n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return t}(),L={}.hasOwnProperty;l=r(L,"undefined")||r(L.call,"undefined")?function(t,e){return e in t&&r(t.constructor.prototype[e],"undefined")}:function(t,e){return L.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var i=F.call(arguments,1),n=function(){if(this instanceof n){var s=function(){};s.prototype=e.prototype;var r=new s,o=e.apply(r,i.concat(F.call(arguments)));return Object(o)===o?o:r}return e.apply(t,i.concat(F.call(arguments)))};return n}),M.flexbox=function(){return c("flexWrap")},M.flexboxlegacy=function(){return c("boxDirection")},M.canvas=function(){var t=e.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},M.canvastext=function(){return!(!f.canvas||!r(e.createElement("canvas").getContext("2d").fillText,"function"))},M.webgl=function(){return!!t.WebGLRenderingContext},M.touch=function(){var i;return"ontouchstart"in t||t.DocumentTouch&&e instanceof DocumentTouch?i=!0:D(["@media (",x.join("touch-enabled),("),m,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(t){i=9===t.offsetTop}),i},M.geolocation=function(){return"geolocation"in navigator},M.postmessage=function(){return!!t.postMessage},M.websqldatabase=function(){return!!t.openDatabase},M.indexedDB=function(){return!!c("indexedDB",t)},M.hashchange=function(){return k("hashchange",t)&&(e.documentMode===i||e.documentMode>7)},M.history=function(){return!(!t.history||!history.pushState)},M.draganddrop=function(){var t=e.createElement("div");return"draggable"in t||"ondragstart"in t&&"ondrop"in t},M.websockets=function(){return"WebSocket"in t||"MozWebSocket"in t},M.rgba=function(){return n("background-color:rgba(150,255,150,.5)"),o(v.backgroundColor,"rgba")},M.hsla=function(){return n("background-color:hsla(120,40%,100%,.5)"),o(v.backgroundColor,"rgba")||o(v.backgroundColor,"hsla")},M.multiplebgs=function(){return n("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(v.background)},M.backgroundsize=function(){return c("backgroundSize")},M.borderimage=function(){return c("borderImage")},M.borderradius=function(){return c("borderRadius")},M.boxshadow=function(){return c("boxShadow")},M.textshadow=function(){return""===e.createElement("div").style.textShadow},M.opacity=function(){return s("opacity:.55"),/^0.55$/.test(v.opacity)},M.cssanimations=function(){return c("animationName")},M.csscolumns=function(){return c("columnCount")},M.cssgradients=function(){var t="background-image:",e="gradient(linear,left top,right bottom,from(#9f9),to(white));",i="linear-gradient(left top,#9f9, white);";return n((t+"-webkit- ".split(" ").join(e+t)+x.join(i+t)).slice(0,-t.length)),o(v.backgroundImage,"gradient")},M.cssreflections=function(){return c("boxReflect")},M.csstransforms=function(){return!!c("transform")},M.csstransforms3d=function(){var t=!!c("perspective");return t&&"webkitPerspective"in _.style&&D("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(e){t=9===e.offsetLeft&&3===e.offsetHeight}),t},M.csstransitions=function(){return c("transition")},M.fontface=function(){var t;return D('@font-face {font-family:"font";src:url("https://")}',function(i,n){var s=e.getElementById("smodernizr"),r=s.sheet||s.styleSheet,o=r?r.cssRules&&r.cssRules[0]?r.cssRules[0].cssText:r.cssText||"":"";t=/src/i.test(o)&&0===o.indexOf(n.split(" ")[0])}),t},M.generatedcontent=function(){var t;return D(["#",m,"{font:0/0 a}#",m,':after{content:"',b,'";visibility:hidden;font:3px/1 a}'].join(""),function(e){t=e.offsetHeight>=3}),t},M.video=function(){var t=e.createElement("video"),i=!1;try{(i=!!t.canPlayType)&&(i=new Boolean(i),i.ogg=t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),i.h264=t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),i.webm=t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(n){}return i},M.audio=function(){var t=e.createElement("audio"),i=!1;try{(i=!!t.canPlayType)&&(i=new Boolean(i),i.ogg=t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),i.mp3=t.canPlayType("audio/mpeg;").replace(/^no$/,""),i.wav=t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),i.m4a=(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(n){}return i},M.localstorage=function(){try{return localStorage.setItem(m,m),localStorage.removeItem(m),!0}catch(t){return!1}},M.sessionstorage=function(){try{return sessionStorage.setItem(m,m),sessionStorage.removeItem(m),!0}catch(t){return!1}},M.webworkers=function(){return!!t.Worker},M.applicationcache=function(){return!!t.applicationCache},M.svg=function(){return!!e.createElementNS&&!!e.createElementNS(T.svg,"svg").createSVGRect},M.inlinesvg=function(){var t=e.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==T.svg},M.smil=function(){return!!e.createElementNS&&/SVGAnimate/.test(S.call(e.createElementNS(T.svg,"animate")))},M.svgclippaths=function(){return!!e.createElementNS&&/SVGClipPath/.test(S.call(e.createElementNS(T.svg,"clipPath")))};for(var A in M)l(M,A)&&(p=A.toLowerCase(),f[p]=M[A](),C.push((f[p]?"":"no-")+p));return f.input||u(),f.addTest=function(t,e){if("object"==typeof t)for(var n in t)l(t,n)&&f.addTest(n,t[n]);else{if(t=t.toLowerCase(),f[t]!==i)return f;e="function"==typeof e?e():e,"undefined"!=typeof g&&g&&(_.className+=" "+(e?"":"no-")+t),f[t]=e}return f},n(""),y=O=null,function(t,e){function i(t,e){var i=t.createElement("p"),n=t.getElementsByTagName("head")[0]||t.documentElement;return i.innerHTML="x<style>"+e+"</style>",n.insertBefore(i.lastChild,n.firstChild)}function n(){var t=y.elements;return"string"==typeof t?t.split(" "):t}function s(t){var e=m[t[g]];return e||(e={},_++,t[g]=_,m[_]=e),e}function r(t,i,n){if(i||(i=e),u)return i.createElement(t);n||(n=s(i));var r;return r=n.cache[t]?n.cache[t].cloneNode():f.test(t)?(n.cache[t]=n.createElem(t)).cloneNode():n.createElem(t),!r.canHaveChildren||d.test(t)||r.tagUrn?r:n.frag.appendChild(r)}function o(t,i){if(t||(t=e),u)return t.createDocumentFragment();i=i||s(t);for(var r=i.frag.cloneNode(),o=0,a=n(),h=a.length;h>o;o++)r.createElement(a[o]);return r}function a(t,e){e.cache||(e.cache={},e.createElem=t.createElement,e.createFrag=t.createDocumentFragment,e.frag=e.createFrag()),t.createElement=function(i){return y.shivMethods?r(i,t,e):e.createElem(i)},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/[\w\-]+/g,function(t){return e.createElem(t),e.frag.createElement(t),'c("'+t+'")'})+");return n}")(y,e.frag)}function h(t){t||(t=e);var n=s(t);return!y.shivCSS||c||n.hasCSS||(n.hasCSS=!!i(t,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),u||a(t,n),t}var c,u,p="3.7.0",l=t.html5||{},d=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,g="_html5shiv",_=0,m={};!function(){try{var t=e.createElement("a");t.innerHTML="<xyz></xyz>",c="hidden"in t,u=1==t.childNodes.length||function(){e.createElement("a");var t=e.createDocumentFragment();return"undefined"==typeof t.cloneNode||"undefined"==typeof t.createDocumentFragment||"undefined"==typeof t.createElement}()}catch(i){c=!0,u=!0}}();var y={elements:l.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:p,shivCSS:l.shivCSS!==!1,supportsUnknownElements:u,shivMethods:l.shivMethods!==!1,type:"default",shivDocument:h,createElement:r,createDocumentFragment:o};t.html5=y,h(e)}(this,e),f._version=d,f._prefixes=x,f._domPrefixes=E,f._cssomPrefixes=w,f.mq=I,f.hasEvent=k,f.testProp=function(t){return a([t])},f.testAllProps=c,f.testStyles=D,f.prefixed=function(t,e,i){return e?c(t,e,i):c(t,"pfx")},_.className=_.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(g?" js "+C.join(" "):""),f}(this,this.document),define(["./core","./selector","./traversing","./callbacks","./deferred","./core/ready","./data","./queue","./queue/delay","./attributes","./event","./event/alias","./manipulation","./manipulation/_evalUrl","./wrap","./css","./css/hiddenVisibleSelectors","./serialize","./ajax","./ajax/xhr","./ajax/script","./ajax/jsonp","./ajax/load","./event/ajax","./effects","./effects/animatedSelector","./offset","./dimensions","./deprecated","./exports/amd","./exports/global"],function(t){return t});var requirejs,require,define;!function(global){function isFunction(t){return"[object Function]"===ostring.call(t)}function isArray(t){return"[object Array]"===ostring.call(t)}function each(t,e){if(t){var i;for(i=0;i<t.length&&(!t[i]||!e(t[i],i,t));i+=1);}}function eachReverse(t,e){if(t){var i;for(i=t.length-1;i>-1&&(!t[i]||!e(t[i],i,t));i-=1);}}function hasProp(t,e){return hasOwn.call(t,e)}function getOwn(t,e){return hasProp(t,e)&&t[e]}function eachProp(t,e){var i;for(i in t)if(hasProp(t,i)&&e(t[i],i))break}function mixin(t,e,i,n){return e&&eachProp(e,function(e,s){(i||!hasProp(t,s))&&(!n||"object"!=typeof e||!e||isArray(e)||isFunction(e)||e instanceof RegExp?t[s]=e:(t[s]||(t[s]={}),mixin(t[s],e,i,n)))}),t}function bind(t,e){return function(){return e.apply(t,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(t){throw t}function getGlobal(t){if(!t)return t;var e=global;return each(t.split("."),function(t){e=e[t]}),e}function makeError(t,e,i,n){var s=new Error(e+"\nhttp://requirejs.org/docs/errors.html#"+t);return s.requireType=t,s.requireModules=n,i&&(s.originalError=i),s}function newContext(t){function e(t){var e,i;for(e=0;e<t.length;e++)if(i=t[e],"."===i)t.splice(e,1),e-=1;else if(".."===i){if(0===e||1===e&&".."===t[2]||".."===t[e-1])continue;e>0&&(t.splice(e-1,2),e-=2)}}function i(t,i,n){var s,r,o,a,h,c,u,p,l,d,f,g,_=i&&i.split("/"),m=x.map,y=m&&m["*"];if(t&&(t=t.split("/"),u=t.length-1,x.nodeIdCompat&&jsSuffixRegExp.test(t[u])&&(t[u]=t[u].replace(jsSuffixRegExp,"")),"."===t[0].charAt(0)&&_&&(g=_.slice(0,_.length-1),t=g.concat(t)),e(t),t=t.join("/")),n&&m&&(_||y)){o=t.split("/");t:for(a=o.length;a>0;a-=1){if(c=o.slice(0,a).join("/"),_)for(h=_.length;h>0;h-=1)if(r=getOwn(m,_.slice(0,h).join("/")),r&&(r=getOwn(r,c))){p=r,l=a;break t}!d&&y&&getOwn(y,c)&&(d=getOwn(y,c),f=a)}!p&&d&&(p=d,l=f),p&&(o.splice(0,l,p),t=o.join("/"))}return s=getOwn(x.pkgs,t),s?s:t}function n(t){isBrowser&&each(scripts(),function(e){return e.getAttribute("data-requiremodule")===t&&e.getAttribute("data-requirecontext")===O.contextName?(e.parentNode.removeChild(e),!0):void 0})}function s(t){var e=getOwn(x.paths,t);return e&&isArray(e)&&e.length>1?(e.shift(),O.require.undef(t),O.makeRequire(null,{skipMap:!0})([t]),!0):void 0}function r(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function o(t,e,n,s){var o,a,h,c,u=null,p=e?e.name:null,l=t,d=!0,f="";return t||(d=!1,t="_@r"+(C+=1)),c=r(t),u=c[0],t=c[1],u&&(u=i(u,p,s),a=getOwn(M,u)),t&&(u?f=a&&a.normalize?a.normalize(t,function(t){return i(t,p,s)}):-1===t.indexOf("!")?i(t,p,s):t:(f=i(t,p,s),c=r(f),u=c[0],f=c[1],n=!0,o=O.nameToUrl(f))),h=!u||a||n?"":"_unnormalized"+(F+=1),{prefix:u,name:f,parentMap:e,unnormalized:!!h,url:o,originalName:l,isDefine:d,id:(u?u+"!"+f:f)+h}}function a(t){var e=t.id,i=getOwn(z,e);return i||(i=z[e]=new O.Module(t)),i}function h(t,e,i){var n=t.id,s=getOwn(z,n);!hasProp(M,n)||s&&!s.defineEmitComplete?(s=a(t),s.error&&"error"===e?i(s.error):s.on(e,i)):"defined"===e&&i(M[n])}function c(t,e){var i=t.requireModules,n=!1;e?e(t):(each(i,function(e){var i=getOwn(z,e);i&&(i.error=t,i.events.error&&(n=!0,i.emit("error",t)))}),n||req.onError(t))}function u(){globalDefQueue.length&&(apsp.apply(T,[T.length,0].concat(globalDefQueue)),globalDefQueue=[])}function p(t){delete z[t],delete w[t]}function l(t,e,i){var n=t.map.id;t.error?t.emit("error",t.error):(e[n]=!0,each(t.depMaps,function(n,s){var r=n.id,o=getOwn(z,r);!o||t.depMatched[s]||i[r]||(getOwn(e,r)?(t.defineDep(s,M[r]),t.check()):l(o,e,i))}),i[n]=!0)}function d(){var t,e,i=1e3*x.waitSeconds,r=i&&O.startTime+i<(new Date).getTime(),o=[],a=[],h=!1,u=!0;if(!y){if(y=!0,eachProp(w,function(t){var i=t.map,c=i.id;if(t.enabled&&(i.isDefine||a.push(t),!t.error))if(!t.inited&&r)s(c)?(e=!0,h=!0):(o.push(c),n(c));else if(!t.inited&&t.fetched&&i.isDefine&&(h=!0,!i.prefix))return u=!1}),r&&o.length)return t=makeError("timeout","Load timeout for modules: "+o,null,o),t.contextName=O.contextName,c(t);u&&each(a,function(t){l(t,{},{})}),r&&!e||!h||!isBrowser&&!isWebWorker||S||(S=setTimeout(function(){S=0,d()},50)),y=!1}}function f(t){hasProp(M,t[0])||a(o(t[0],null,!0)).init(t[1],t[2])}function g(t,e,i,n){t.detachEvent&&!isOpera?n&&t.detachEvent(n,e):t.removeEventListener(i,e,!1)}function _(t){var e=t.currentTarget||t.srcElement;return g(e,O.onScriptLoad,"load","onreadystatechange"),g(e,O.onScriptError,"error"),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function m(){var t;for(u();T.length;){if(t=T.shift(),null===t[0])return c(makeError("mismatch","Mismatched anonymous define() module: "+t[t.length-1]));f(t)}}var y,v,O,b,S,x={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},z={},w={},E={},T=[],M={},P={},N={},C=1,F=1;return b={require:function(t){return t.require?t.require:t.require=O.makeRequire(t.map)},exports:function(t){return t.usingExports=!0,t.map.isDefine?t.exports?M[t.map.id]=t.exports:t.exports=M[t.map.id]={}:void 0},module:function(t){return t.module?t.module:t.module={id:t.map.id,uri:t.map.url,config:function(){return getOwn(x.config,t.map.id)||{}},exports:t.exports||(t.exports={})}}},v=function(t){this.events=getOwn(E,t.id)||{},this.map=t,this.shim=getOwn(x.shim,t.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},v.prototype={init:function(t,e,i,n){n=n||{},this.inited||(this.factory=e,i?this.on("error",i):this.events.error&&(i=bind(this,function(t){this.emit("error",t)})),this.depMaps=t&&t.slice(0),this.errback=i,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(t,e){this.depMatched[t]||(this.depMatched[t]=!0,this.depCount-=1,this.depExports[t]=e)},fetch:function(){if(!this.fetched){this.fetched=!0,O.startTime=(new Date).getTime();var t=this.map;return this.shim?void O.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return t.prefix?this.callPlugin():this.load()})):t.prefix?this.callPlugin():this.load()}},load:function(){var t=this.map.url;P[t]||(P[t]=!0,O.load(this.map.id,t))},check:function(){if(this.enabled&&!this.enabling){var t,e,i=this.map.id,n=this.depExports,s=this.exports,r=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(r)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{s=O.execCb(i,r,n,s)}catch(o){t=o}else s=O.execCb(i,r,n,s);if(this.map.isDefine&&void 0===s&&(e=this.module,e?s=e.exports:this.usingExports&&(s=this.exports)),t)return t.requireMap=this.map,t.requireModules=this.map.isDefine?[this.map.id]:null,t.requireType=this.map.isDefine?"define":"require",c(this.error=t)}else s=r;this.exports=s,this.map.isDefine&&!this.ignore&&(M[i]=s,req.onResourceLoad&&req.onResourceLoad(O,this.map,this.depMaps)),p(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var t=this.map,e=t.id,n=o(t.prefix);this.depMaps.push(n),h(n,"defined",bind(this,function(n){var s,r,u,l=getOwn(N,this.map.id),d=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,g=O.makeRequire(t.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(d=n.normalize(d,function(t){return i(t,f,!0)})||""),r=o(t.prefix+"!"+d,this.map.parentMap),h(r,"defined",bind(this,function(t){this.init([],function(){return t},null,{enabled:!0,ignore:!0})})),u=getOwn(z,r.id),void(u&&(this.depMaps.push(r),this.events.error&&u.on("error",bind(this,function(t){this.emit("error",t)})),u.enable()))):l?(this.map.url=O.nameToUrl(l),void this.load()):(s=bind(this,function(t){this.init([],function(){return t},null,{enabled:!0})}),s.error=bind(this,function(t){this.inited=!0,this.error=t,t.requireModules=[e],eachProp(z,function(t){0===t.map.id.indexOf(e+"_unnormalized")&&p(t.map.id)}),c(t)}),s.fromText=bind(this,function(i,n){var r=t.name,h=o(r),u=useInteractive;n&&(i=n),u&&(useInteractive=!1),a(h),hasProp(x.config,e)&&(x.config[r]=x.config[e]);try{req.exec(i)}catch(p){return c(makeError("fromtexteval","fromText eval for "+e+" failed: "+p,p,[e]))}u&&(useInteractive=!0),this.depMaps.push(h),O.completeLoad(r),g([r],s)}),void n.load(t.name,g,s,x))})),O.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){w[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(t,e){var i,n,s;if("string"==typeof t){if(t=o(t,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[e]=t,s=getOwn(b,t.id))return void(this.depExports[e]=s(this));this.depCount+=1,h(t,"defined",bind(this,function(t){this.defineDep(e,t),this.check()})),this.errback?h(t,"error",bind(this,this.errback)):this.events.error&&h(t,"error",bind(this,function(t){this.emit("error",t)}))}i=t.id,n=z[i],hasProp(b,i)||!n||n.enabled||O.enable(t,this)})),eachProp(this.pluginMaps,bind(this,function(t){var e=getOwn(z,t.id);e&&!e.enabled&&O.enable(t,this)})),this.enabling=!1,this.check()},on:function(t,e){var i=this.events[t];i||(i=this.events[t]=[]),i.push(e)},emit:function(t,e){each(this.events[t],function(t){t(e)}),"error"===t&&delete this.events[t]}},O={config:x,contextName:t,registry:z,defined:M,urlFetched:P,defQueue:T,Module:v,makeModuleMap:o,nextTick:req.nextTick,onError:c,configure:function(t){t.baseUrl&&"/"!==t.baseUrl.charAt(t.baseUrl.length-1)&&(t.baseUrl+="/");var e=x.shim,i={paths:!0,bundles:!0,config:!0,map:!0};eachProp(t,function(t,e){i[e]?(x[e]||(x[e]={}),mixin(x[e],t,!0,!0)):x[e]=t}),t.bundles&&eachProp(t.bundles,function(t,e){each(t,function(t){t!==e&&(N[t]=e)})}),t.shim&&(eachProp(t.shim,function(t,i){isArray(t)&&(t={deps:t}),!t.exports&&!t.init||t.exportsFn||(t.exportsFn=O.makeShimExports(t)),e[i]=t}),x.shim=e),t.packages&&each(t.packages,function(t){var e,i;t="string"==typeof t?{name:t}:t,i=t.name,e=t.location,e&&(x.paths[i]=t.location),x.pkgs[i]=t.name+"/"+(t.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(z,function(t,e){t.inited||t.map.unnormalized||(t.map=o(e))}),(t.deps||t.callback)&&O.require(t.deps||[],t.callback)},makeShimExports:function(t){function e(){var e;return t.init&&(e=t.init.apply(global,arguments)),e||t.exports&&getGlobal(t.exports)}return e},makeRequire:function(e,s){function r(i,n,h){var u,p,l;return s.enableBuildCallback&&n&&isFunction(n)&&(n.__requireJsBuild=!0),"string"==typeof i?isFunction(n)?c(makeError("requireargs","Invalid require call"),h):e&&hasProp(b,i)?b[i](z[e.id]):req.get?req.get(O,i,e,r):(p=o(i,e,!1,!0),u=p.id,hasProp(M,u)?M[u]:c(makeError("notloaded",'Module name "'+u+'" has not been loaded yet for context: '+t+(e?"":". Use require([])")))):(m(),O.nextTick(function(){m(),l=a(o(null,e)),l.skipMap=s.skipMap,l.init(i,n,h,{enabled:!0}),d()}),r)}return s=s||{},mixin(r,{isBrowser:isBrowser,toUrl:function(t){var n,s=t.lastIndexOf("."),r=t.split("/")[0],o="."===r||".."===r;return-1!==s&&(!o||s>1)&&(n=t.substring(s,t.length),t=t.substring(0,s)),O.nameToUrl(i(t,e&&e.id,!0),n,!0)},defined:function(t){return hasProp(M,o(t,e,!1,!0).id)},specified:function(t){return t=o(t,e,!1,!0).id,hasProp(M,t)||hasProp(z,t)}}),e||(r.undef=function(t){u();var i=o(t,e,!0),s=getOwn(z,t);n(t),delete M[t],delete P[i.url],delete E[t],eachReverse(T,function(e,i){e[0]===t&&T.splice(i,1)}),s&&(s.events.defined&&(E[t]=s.events),p(t))}),r},enable:function(t){var e=getOwn(z,t.id);e&&a(t).enable()},completeLoad:function(t){var e,i,n,r=getOwn(x.shim,t)||{},o=r.exports;for(u();T.length;){if(i=T.shift(),null===i[0]){if(i[0]=t,e)break;e=!0}else i[0]===t&&(e=!0);f(i)}if(n=getOwn(z,t),!e&&!hasProp(M,t)&&n&&!n.inited){if(!(!x.enforceDefine||o&&getGlobal(o)))return s(t)?void 0:c(makeError("nodefine","No define call for "+t,null,[t]));f([t,r.deps||[],r.exportsFn])}d()},nameToUrl:function(t,e,i){var n,s,r,o,a,h,c,u=getOwn(x.pkgs,t);if(u&&(t=u),c=getOwn(N,t))return O.nameToUrl(c,e,i);if(req.jsExtRegExp.test(t))a=t+(e||"");else{for(n=x.paths,s=t.split("/"),r=s.length;r>0;r-=1)if(o=s.slice(0,r).join("/"),h=getOwn(n,o)){isArray(h)&&(h=h[0]),s.splice(0,r,h);break}a=s.join("/"),a+=e||(/^data\:|\?/.test(a)||i?"":".js"),a=("/"===a.charAt(0)||a.match(/^[\w\+\.\-]+:/)?"":x.baseUrl)+a}return x.urlArgs?a+((-1===a.indexOf("?")?"?":"&")+x.urlArgs):a},load:function(t,e){req.load(O,t,e)},execCb:function(t,e,i,n){return e.apply(n,i)},onScriptLoad:function(t){if("load"===t.type||readyRegExp.test((t.currentTarget||t.srcElement).readyState)){interactiveScript=null;var e=_(t);O.completeLoad(e.id)}},onScriptError:function(t){var e=_(t);return s(e.id)?void 0:c(makeError("scripterror","Script error for: "+e.id,t,[e.id]))}},O.require=O.makeRequire(),O}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(t){return"interactive"===t.readyState?interactiveScript=t:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.17",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(t,e,i,n){var s,r,o=defContextName;return isArray(t)||"string"==typeof t||(r=t,isArray(e)?(t=e,e=i,i=n):t=[]),r&&r.context&&(o=r.context),s=getOwn(contexts,o),s||(s=contexts[o]=req.s.newContext(o)),r&&s.configure(r),s.require(t,e,i)},req.config=function(t){return req(t)},req.nextTick="undefined"!=typeof setTimeout?function(t){setTimeout(t,4)}:function(t){t()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(t){req[t]=function(){var e=contexts[defContextName];return e.require[t].apply(e,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(t){var e=t.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return e.type=t.scriptType||"text/javascript",e.charset="utf-8",e.async=!0,e},req.load=function(t,e,i){var n,s=t&&t.config||{};if(isBrowser)return n=req.createNode(s,e,i),n.setAttribute("data-requirecontext",t.contextName),n.setAttribute("data-requiremodule",e),!n.attachEvent||n.attachEvent.toString&&n.attachEvent.toString().indexOf("[native code")<0||isOpera?(n.addEventListener("load",t.onScriptLoad,!1),n.addEventListener("error",t.onScriptError,!1)):(useInteractive=!0,n.attachEvent("onreadystatechange",t.onScriptLoad)),n.src=i,currentlyAddingScript=n,baseElement?head.insertBefore(n,baseElement):head.appendChild(n),currentlyAddingScript=null,n;if(isWebWorker)try{importScripts(i),t.completeLoad(e)}catch(r){t.onError(makeError("importscripts","importScripts failed for "+e+" at "+i,r,[e]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(t){return head||(head=t.parentNode),dataMain=t.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(t,e,i){var n,s;"string"!=typeof t&&(i=e,e=t,t=null),isArray(e)||(i=e,e=null),!e&&isFunction(i)&&(e=[],i.length&&(i.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(t,i){e.push(i)}),e=(1===i.length?["require"]:["require","exports","module"]).concat(e))),useInteractive&&(n=currentlyAddingScript||getInteractiveScript(),n&&(t||(t=n.getAttribute("data-requiremodule")),s=contexts[n.getAttribute("data-requirecontext")])),(s?s.defQueue:globalDefQueue).push([t,e,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define(function(t,e,i){function n(){var t=this.container;return[t.clientWidth,t.clientHeight]}function s(t){this.container=t,this._allocator=new a(t),this._node=new r,this._eventOutput=new o,this._size=n.call(this),this._perspectiveState=new c(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:h.identity,opacity:1,origin:u,align:u,size:this._size},this._eventOutput.on("resize",function(){this.setSize(n.call(this))}.bind(this))}var r=t("./RenderNode"),o=t("./EventHandler"),a=t("./ElementAllocator"),h=t("./Transform"),c=t("../transitions/Transitionable"),u=[0,0],p=!("perspective"in document.documentElement.style),l=p?function(t,e){t.style.webkitPerspective=e?e.toFixed()+"px":""}:function(t,e){t.style.perspective=e?e.toFixed()+"px":""};s.prototype.getAllocator=function(){return this._allocator},s.prototype.add=function(t){return this._node.add(t)},s.prototype.migrate=function(t){t!==this.container&&(this.container=t,this._allocator.migrate(t))},s.prototype.getSize=function(){return this._size},s.prototype.setSize=function(t){t||(t=n.call(this)),this._size[0]=t[0],this._size[1]=t[1]},s.prototype.update=function(t){t&&(t.transform&&(this._nodeContext.transform=t.transform),t.opacity&&(this._nodeContext.opacity=t.opacity),t.origin&&(this._nodeContext.origin=t.origin),t.align&&(this._nodeContext.align=t.align),t.size&&(this._nodeContext.size=t.size));var e=this._perspectiveState.get();e!==this._perspective&&(l(this.container,e),this._perspective=e),this._node.commit(this._nodeContext)},s.prototype.getPerspective=function(){return this._perspectiveState.get()},s.prototype.setPerspective=function(t,e,i){return this._perspectiveState.set(t,e,i)},s.prototype.emit=function(t,e){return this._eventOutput.emit(t,e)},s.prototype.on=function(t,e){return this._eventOutput.on(t,e)},s.prototype.removeListener=function(t,e){return this._eventOutput.removeListener(t,e)},s.prototype.pipe=function(t){return this._eventOutput.pipe(t)},s.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},i.exports=s}),define(function(t,e,i){function n(t){t||(t=document.createDocumentFragment()),this.container=t,this.detachedNodes={},this.nodeCount=0}n.prototype.migrate=function(t){var e=this.container;if(t!==e){if(e instanceof DocumentFragment)t.appendChild(e);else for(;e.hasChildNodes();)t.appendChild(e.firstChild);this.container=t}},n.prototype.allocate=function(t){t=t.toLowerCase(),t in this.detachedNodes||(this.detachedNodes[t]=[]);var e,i=this.detachedNodes[t];return i.length>0?e=i.pop():(e=document.createElement(t),this.container.appendChild(e)),this.nodeCount++,e},n.prototype.deallocate=function(t){var e=t.nodeName.toLowerCase(),i=this.detachedNodes[e];i.push(t),this.nodeCount--},n.prototype.getNodeCount=function(){return this.nodeCount},i.exports=n}),define(function(t,e,i){function n(t){this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this._eventOutput=new u,this._eventOutput.bindThis(this),this.eventForwarder=function(t){this._eventOutput.emit(t.type,t)}.bind(this),this.id=c.register(this),this._element=null,this._sizeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._invisible=!1,t&&this.attach(t)}function s(t){for(var e in this._eventOutput.listeners)t.addEventListener(e,this.eventForwarder)}function r(t){for(var e in this._eventOutput.listeners)t.removeEventListener(e,this.eventForwarder)}function o(t){t[12]=Math.round(t[12]*d)/d,t[13]=Math.round(t[13]*d)/d;for(var e="matrix3d(",i=0;15>i;i++)e+=t[i]<1e-6&&t[i]>-1e-6?"0,":t[i]+",";
return e+=t[15]+")"}function a(t){return 100*t[0]+"% "+100*t[1]+"%"}function h(t,e){return t&&e?t[0]!==e[0]||t[1]!==e[1]:t!==e}var c=t("./Entity"),u=t("./EventHandler"),p=t("./Transform"),l=!("transform"in document.documentElement.style),d=window.devicePixelRatio||1;n.prototype.on=function(t,e){this._element&&this._element.addEventListener(t,this.eventForwarder),this._eventOutput.on(t,e)},n.prototype.removeListener=function(t,e){this._eventOutput.removeListener(t,e)},n.prototype.emit=function(t,e){e&&!e.origin&&(e.origin=this);var i=this._eventOutput.emit(t,e);return i&&e&&e.stopPropagation&&e.stopPropagation(),i},n.prototype.pipe=function(t){return this._eventOutput.pipe(t)},n.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},n.prototype.render=function(){return this.id};var f;f=l?function(t,e){t.style.webkitTransform=o(e)}:function(t,e){t.style.transform=o(e)};var g=l?function(t,e){t.style.webkitTransformOrigin=a(e)}:function(t,e){t.style.transformOrigin=a(e)},_=l?function(t){t.style.webkitTransform="scale3d(0.0001,0.0001,0.0001)",t.style.opacity=0}:function(t){t.style.transform="scale3d(0.0001,0.0001,0.0001)",t.style.opacity=0};n.prototype.commit=function(t){var e=this._element;if(e){{var i=t.transform,n=t.opacity,s=t.origin;t.size}if(!i&&this._matrix)return this._matrix=null,this._opacity=0,void _(e);if(h(this._origin,s)&&(this._originDirty=!0),p.notEquals(this._matrix,i)&&(this._transformDirty=!0),this._invisible&&(this._invisible=!1,this._element.style.display=""),this._opacity!==n&&(this._opacity=n,e.style.opacity=n>=1?"0.999999":n),this._transformDirty||this._originDirty||this._sizeDirty){this._sizeDirty&&(this._sizeDirty=!1),this._originDirty&&(s?(this._origin||(this._origin=[0,0]),this._origin[0]=s[0],this._origin[1]=s[1]):this._origin=null,g(e,this._origin),this._originDirty=!1),i||(i=p.identity),this._matrix=i;var r=this._size?p.thenMove(i,[-this._size[0]*s[0],-this._size[1]*s[1],0]):i;f(e,r),this._transformDirty=!1}}},n.prototype.cleanup=function(){this._element&&(this._invisible=!0,this._element.style.display="none")},n.prototype.attach=function(t){this._element=t,s.call(this,t)},n.prototype.detach=function(){var t=this._element;return t&&(r.call(this,t),this._invisible&&(this._invisible=!1,this._element.style.display="")),this._element=null,t},i.exports=n}),define(function(t,e,i){function n(){z.runLoop?(f.step(),window.requestAnimationFrame(n)):b=!1}function s(){for(var t=0;t<g.length;t++)g[t].emit("resize");x.emit("resize")}function r(){window.addEventListener("touchmove",function(t){t.preventDefault()},!0),o()}function o(){return document.body?(document.body.classList.add("famous-root"),void document.documentElement.classList.add("famous-root")):void f.nextTick(o)}function a(t,e){return document.body?void document.body.addEventListener(t,e):void f.nextTick(addEventListener.bind(this,t,e))}function h(t,e){return document.body?(document.body.appendChild(e),void t.emit("resize")):void f.nextTick(h.bind(this,t,e))}var c,u,p=t("./Context"),l=t("./EventHandler"),d=t("./OptionsManager"),f={},g=[],_=[],m=0,y=0,v=[],O=Date.now(),b=!0,S={},x=new l,z={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0,appMode:!0},w=new d(z),E=10;f.step=function(){m++,y=m;var t=Date.now();if(!(u&&u>t-O)){var e=0;c=t-O,O=t,x.emit("prerender");for(var i=_.length;i--;)_.shift()(m);for(;v.length&&Date.now()-t<E;)v.shift().call(this);for(e=0;e<g.length;e++)g[e].update();x.emit("postrender")}},window.requestAnimationFrame(n),window.addEventListener("resize",s,!1),s();var T=!1;f.pipe=function(t){return t.subscribe instanceof Function?t.subscribe(f):x.pipe(t)},f.unpipe=function(t){return t.unsubscribe instanceof Function?t.unsubscribe(f):x.unpipe(t)},f.on=function(t,e){return t in S||(S[t]=x.emit.bind(x,t),a(t,S[t])),x.on(t,e)},f.emit=function(t,e){return x.emit(t,e)},f.removeListener=function(t,e){return x.removeListener(t,e)},f.getFPS=function(){return 1e3/c},f.setFPSCap=function(t){u=Math.floor(1e3/t)},f.getOptions=function(t){return w.getOptions(t)},f.setOptions=function(){return w.setOptions.apply(w,arguments)},f.createContext=function(t){!T&&z.appMode&&f.nextTick(r);var e=!1;t||(t=document.createElement(z.containerType),t.classList.add(z.containerClass),e=!0);var i=new p(t);return f.registerContext(i),e&&h(i,t),i},f.registerContext=function(t){return g.push(t),t},f.getContexts=function(){return g},f.deregisterContext=function(t){var e=g.indexOf(t);e>=0&&g.splice(e,1)},f.nextTick=function(t){_.push(t)},f.defer=function(t){v.push(t)},w.on("change",function(t){"fpsCap"===t.id?f.setFPSCap(t.value):"runLoop"===t.id&&!b&&t.value&&(b=!0,window.requestAnimationFrame(n))}),i.exports=f}),define(function(t,e,i){function n(t){return a[t]}function s(t,e){a[t]=e}function r(t){var e=a.length;return s(e,t),e}function o(t){s(t,null)}var a=[];i.exports={register:r,unregister:o,get:n,set:s}}),define(function(t,e,i){function n(){this.listeners={},this._owner=this}n.prototype.emit=function(t,e){var i=this.listeners[t];if(i)for(var n=0;n<i.length;n++)i[n].call(this._owner,e);return this},n.prototype.on=function(t,e){t in this.listeners||(this.listeners[t]=[]);var i=this.listeners[t].indexOf(e);return 0>i&&this.listeners[t].push(e),this},n.prototype.addListener=n.prototype.on,n.prototype.removeListener=function(t,e){var i=this.listeners[t];if(void 0!==i){var n=i.indexOf(e);n>=0&&i.splice(n,1)}return this},n.prototype.bindThis=function(t){this._owner=t},i.exports=n}),define(function(t,e,i){function n(){s.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var s=t("./EventEmitter");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.setInputHandler=function(t,e){t.trigger=e.trigger.bind(e),e.subscribe&&e.unsubscribe&&(t.subscribe=e.subscribe.bind(e),t.unsubscribe=e.unsubscribe.bind(e))},n.setOutputHandler=function(t,e){e instanceof n&&e.bindThis(t),t.pipe=e.pipe.bind(e),t.unpipe=e.unpipe.bind(e),t.on=e.on.bind(e),t.addListener=t.on,t.removeListener=e.removeListener.bind(e)},n.prototype.emit=function(t,e){s.prototype.emit.apply(this,arguments);var i=0;for(i=0;i<this.downstream.length;i++)this.downstream[i].trigger&&this.downstream[i].trigger(t,e);for(i=0;i<this.downstreamFn.length;i++)this.downstreamFn[i](t,e);return this},n.prototype.trigger=n.prototype.emit,n.prototype.pipe=function(t){if(t.subscribe instanceof Function)return t.subscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,i=e.indexOf(t);return 0>i&&e.push(t),t instanceof Function?t("pipe",null):t.trigger&&t.trigger("pipe",null),t},n.prototype.unpipe=function(t){if(t.unsubscribe instanceof Function)return t.unsubscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,i=e.indexOf(t);return i>=0?(e.splice(i,1),t instanceof Function?t("unpipe",null):t.trigger&&t.trigger("unpipe",null),t):!1},n.prototype.on=function(t){if(s.prototype.on.apply(this,arguments),!(t in this.upstreamListeners)){var e=this.trigger.bind(this,t);this.upstreamListeners[t]=e;for(var i=0;i<this.upstream.length;i++)this.upstream[i].on(t,e)}return this},n.prototype.addListener=n.prototype.on,n.prototype.subscribe=function(t){var e=this.upstream.indexOf(t);if(0>e){this.upstream.push(t);for(var i in this.upstreamListeners)t.on(i,this.upstreamListeners[i])}return this},n.prototype.unsubscribe=function(t){var e=this.upstream.indexOf(t);if(e>=0){this.upstream.splice(e,1);for(var i in this.upstreamListeners)t.removeListener(i,this.upstreamListeners[i])}return this},i.exports=n}),define(function(t,e,i){function n(t){o.call(this,t),this._shouldRecalculateSize=!1,this._container=document.createDocumentFragment(),this.context=new s(this._container),this.setContent(this._container),this._groupSize=[void 0,void 0]}var s=t("./Context"),r=t("./Transform"),o=t("./Surface");n.SIZE_ZERO=[0,0],n.prototype=Object.create(o.prototype),n.prototype.elementType="div",n.prototype.elementClass="famous-group",n.prototype.add=function(){return this.context.add.apply(this.context,arguments)},n.prototype.render=function(){return o.prototype.render.call(this)},n.prototype.deploy=function(t){this.context.migrate(t)},n.prototype.recall=function(){this._container=document.createDocumentFragment(),this.context.migrate(this._container)},n.prototype.commit=function(t){var e=t.transform,i=t.origin,s=t.opacity,a=t.size,h=o.prototype.commit.call(this,{allocator:t.allocator,transform:r.thenMove(e,[-i[0]*a[0],-i[1]*a[1],0]),opacity:s,origin:i,size:n.SIZE_ZERO});return(a[0]!==this._groupSize[0]||a[1]!==this._groupSize[1])&&(this._groupSize[0]=a[0],this._groupSize[1]=a[1],this.context.setSize(a)),this.context.update({transform:r.translate(-i[0]*a[0],-i[1]*a[1],0),origin:i,size:a}),h},i.exports=n}),define(function(t,e,i){function n(t){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null,this._legacyStates={},this._output={transform:r.identity,opacity:1,origin:null,align:null,size:null,proportions:null,target:null},t&&(t.transform&&this.transformFrom(t.transform),void 0!==t.opacity&&this.opacityFrom(t.opacity),t.origin&&this.originFrom(t.origin),t.align&&this.alignFrom(t.align),t.size&&this.sizeFrom(t.size),t.proportions&&this.proportionsFrom(t.proportions))}function s(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter()),this._proportionGetter&&(this._output.proportions=this._proportionGetter())}var r=t("./Transform"),o=t("../transitions/Transitionable"),a=t("../transitions/TransitionableTransform");n.prototype.transformFrom=function(t){return t instanceof Function?this._transformGetter=t:t instanceof Object&&t.get?this._transformGetter=t.get.bind(t):(this._transformGetter=null,this._output.transform=t),this},n.prototype.opacityFrom=function(t){return t instanceof Function?this._opacityGetter=t:t instanceof Object&&t.get?this._opacityGetter=t.get.bind(t):(this._opacityGetter=null,this._output.opacity=t),this},n.prototype.originFrom=function(t){return t instanceof Function?this._originGetter=t:t instanceof Object&&t.get?this._originGetter=t.get.bind(t):(this._originGetter=null,this._output.origin=t),this},n.prototype.alignFrom=function(t){return t instanceof Function?this._alignGetter=t:t instanceof Object&&t.get?this._alignGetter=t.get.bind(t):(this._alignGetter=null,this._output.align=t),this},n.prototype.sizeFrom=function(t){return t instanceof Function?this._sizeGetter=t:t instanceof Object&&t.get?this._sizeGetter=t.get.bind(t):(this._sizeGetter=null,this._output.size=t),this},n.prototype.proportionsFrom=function(t){return t instanceof Function?this._proportionGetter=t:t instanceof Object&&t.get?this._proportionGetter=t.get.bind(t):(this._proportionGetter=null,this._output.proportions=t),this},n.prototype.setTransform=function(t,e,i){return e||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new a(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(t,e,i),this):this.transformFrom(t)},n.prototype.setOpacity=function(t,e,i){return e||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new o(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(t,e,i)):this.opacityFrom(t)},n.prototype.setOrigin=function(t,e,i){return e||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new o(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(t,e,i),this):this.originFrom(t)},n.prototype.setAlign=function(t,e,i){return e||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new o(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(t,e,i),this):this.alignFrom(t)},n.prototype.setSize=function(t,e,i){return t&&(e||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new o(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(t,e,i),this):this.sizeFrom(t)},n.prototype.setProportions=function(t,e,i){return t&&(e||this._legacyStates.proportions)?(this._legacyStates.proportions||(this._legacyStates.proportions=new o(this._output.proportions||[0,0])),this._proportionGetter||this.proportionsFrom(this._legacyStates.proportions),this._legacyStates.proportions.set(t,e,i),this):this.proportionsFrom(t)},n.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._legacyStates.proportions&&this._legacyStates.proportions.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null},n.prototype.getTransform=function(){return this._transformGetter()},n.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},n.prototype.getOpacity=function(){return this._opacityGetter()},n.prototype.getOrigin=function(){return this._originGetter()},n.prototype.getAlign=function(){return this._alignGetter()},n.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},n.prototype.getProportions=function(){return this._proportionGetter?this._proportionGetter():this._output.proportions},n.prototype.modify=function(t){return s.call(this),this._output.target=t,this._output},i.exports=n}),define(function(t,e,i){function n(t){this._value=t,this.eventOutput=null}function s(){this.eventOutput=new r,this.eventOutput.bindThis(this),r.setOutputHandler(this,this.eventOutput)}var r=t("./EventHandler");n.patch=function(t){for(var e=new n(t),i=1;i<arguments.length;i++)e.patch(arguments[i]);return t},n.prototype.patch=function(){for(var t=this._value,e=0;e<arguments.length;e++){var i=arguments[e];for(var n in i)n in t&&i[n]&&i[n].constructor===Object&&t[n]&&t[n].constructor===Object?(t.hasOwnProperty(n)||(t[n]=Object.create(t[n])),this.key(n).patch(i[n]),this.eventOutput&&this.eventOutput.emit("change",{id:n,value:this.key(n).value()})):this.set(n,i[n])}return this},n.prototype.setOptions=n.prototype.patch,n.prototype.key=function(t){var e=new n(this._value[t]);return(!(e._value instanceof Object)||e._value instanceof Array)&&(e._value={}),e},n.prototype.get=function(t){return t?this._value[t]:this._value},n.prototype.getOptions=n.prototype.get,n.prototype.set=function(t,e){var i=this.get(t);return this._value[t]=e,this.eventOutput&&e!==i&&this.eventOutput.emit("change",{id:t,value:e}),this},n.prototype.on=function(){return s.call(this),this.on.apply(this,arguments)},n.prototype.removeListener=function(){return s.call(this),this.removeListener.apply(this,arguments)},n.prototype.pipe=function(){return s.call(this),this.pipe.apply(this,arguments)},n.prototype.unpipe=function(){return s.call(this),this.unpipe.apply(this,arguments)},i.exports=n}),define(function(t,e,i){function n(t){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,t&&this.set(t)}function s(t,e,i){for(var n=o.parse(t,e),a=Object.keys(n),h=0;h<a.length;h++){var c=a[h],u=r.get(c),p=n[c];p.allocator=e.allocator;var l=u.commit(p);l?s(l,e,i):i[c]=p}}var r=t("./Entity"),o=t("./SpecParser");n.prototype.add=function(t){var e=t instanceof n?t:new n(t);return this._child instanceof Array?this._child.push(e):this._child?(this._child=[this._child,e],this._hasMultipleChildren=!0,this._childResult=[]):this._child=e,e},n.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},n.prototype.set=function(t){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=t.render?!0:!1,this._isModifier=t.modify?!0:!1,this._object=t,this._child=null,t instanceof n?t:this},n.prototype.getSize=function(){var t=null,e=this.get();return e&&e.getSize&&(t=e.getSize()),!t&&this._child&&this._child.getSize&&(t=this._child.getSize()),t},n.prototype.commit=function(t){for(var e=Object.keys(this._prevResults),i=0;i<e.length;i++){var n=e[i];if(void 0===this._resultCache[n]){var o=r.get(n);o.cleanup&&o.cleanup(t.allocator)}}this._prevResults=this._resultCache,this._resultCache={},s(this.render(),t,this._resultCache)},n.prototype.render=function(){if(this._isRenderable)return this._object.render();var t=null;if(this._hasMultipleChildren){t=this._childResult;for(var e=this._child,i=0;i<e.length;i++)t[i]=e[i].render()}else this._child&&(t=this._child.render());return this._isModifier?this._object.modify(t):t},i.exports=n}),define(function(t,e,i){function n(t){this.id=null,this._objects=null,this.node=new u,this._definition=null,t&&this.load(t)}function s(t){for(var e in p)if(e in t){var i=t[e];return i instanceof Array||(i=[i]),p[e].apply(this,i)}}function r(t){var e=t.transform,i=t.opacity,n=t.origin,r=t.align,o=t.size,a=h.identity;if(e instanceof Array)if(16===e.length&&"number"==typeof e[0])a=e;else for(var u=0;u<e.length;u++)a=h.multiply(a,s(e[u]));else e instanceof Function?a=e:e instanceof Object&&(a=s(e));var p=new c({transform:a,opacity:i,origin:n,align:r,size:o});return p}function o(t){for(var e=new u,i=0;i<t.length;i++){var n=a.call(this,t[i]);n&&e.add(n)}return e}function a(t){var e,i;if(t instanceof Array)e=o.call(this,t);else if(i=this._objects.length,t.render&&t.render instanceof Function)e=t;else if(t.target){var n=a.call(this,t.target),s=r.call(this,t);e=new u(s),e.add(n),t.id&&(this.id[t.id]=s)}else t.id&&(e=new u,this.id[t.id]=e);return this._objects[i]=e,e}var h=t("./Transform"),c=t("./Modifier"),u=t("./RenderNode"),p={translate:h.translate,rotate:h.rotate,rotateX:h.rotateX,rotateY:h.rotateY,rotateZ:h.rotateZ,rotateAxis:h.rotateAxis,scale:h.scale,skew:h.skew,matrix3d:function(){return arguments}};n.prototype.create=function(){return new n(this._definition)},n.prototype.load=function(t){this._definition=t,this.id={},this._objects=[],this.node.set(a.call(this,t))},n.prototype.add=function(){return this.node.add.apply(this.node,arguments)},n.prototype.render=function(){return this.node.render.apply(this.node,arguments)},i.exports=n}),define(function(t,e,i){function n(){this.result={}}function s(t,e){return[t[0]*e[0]+t[1]*e[4]+t[2]*e[8],t[0]*e[1]+t[1]*e[5]+t[2]*e[9],t[0]*e[2]+t[1]*e[6]+t[2]*e[10]]}var r=t("./Transform");n._instance=new n,n.parse=function(t,e){return n._instance.parse(t,e)},n.prototype.parse=function(t,e){return this.reset(),this._parseSpec(t,e,r.identity),this.result},n.prototype.reset=function(){this.result={}};var o=[0,0];n.prototype._parseSpec=function(t,e,i){var n,a,h,c,u,p,l;if("number"==typeof t){if(n=t,h=e.transform,p=e.align||o,e.size&&p&&(p[0]||p[1])){var d=[p[0]*e.size[0],p[1]*e.size[1],0];h=r.thenMove(h,s(d,i))}this.result[n]={transform:h,opacity:e.opacity,origin:e.origin||o,align:e.align||o,size:e.size}}else{if(!t)return;if(t instanceof Array)for(var f=0;f<t.length;f++)this._parseSpec(t[f],e,i);else{a=t.target,h=e.transform,c=e.opacity,u=e.origin,p=e.align,l=e.size;var g=i;if(void 0!==t.opacity&&(c=e.opacity*t.opacity),t.transform&&(h=r.multiply(e.transform,t.transform)),t.origin&&(u=t.origin,g=e.transform),t.align&&(p=t.align),t.size||t.proportions){var _=l;l=[l[0],l[1]],t.size&&(void 0!==t.size[0]&&(l[0]=t.size[0]),void 0!==t.size[1]&&(l[1]=t.size[1])),t.proportions&&(void 0!==t.proportions[0]&&(l[0]=l[0]*t.proportions[0]),void 0!==t.proportions[1]&&(l[1]=l[1]*t.proportions[1])),_&&(p&&(p[0]||p[1])&&(h=r.thenMove(h,s([p[0]*_[0],p[1]*_[1],0],i))),u&&(u[0]||u[1])&&(h=r.moveThen([-u[0]*l[0],-u[1]*l[1],0],h))),g=e.transform,u=null,p=null}this._parseSpec(a,{transform:h,opacity:c,origin:u,align:p,size:l},g)}}},i.exports=n}),define(function(t,e,i){function n(t){u.call(this),this.options={},this.properties={},this.attributes={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._trueSizeCheck=!0,this._dirtyClasses=[],t&&this.setOptions(t),this._currentTarget=null}function s(t){for(var e=0;e<this._dirtyClasses.length;e++)t.classList.remove(this._dirtyClasses[e]);this._dirtyClasses=[]}function r(t){for(var e in this.properties)t.style[e]=this.properties[e]}function o(t){for(var e in this.properties)t.style[e]=""}function a(t){for(var e in this.attributes)t.setAttribute(e,this.attributes[e])}function h(t){for(var e in this.attributes)t.removeAttribute(e)}function c(t,e){return t&&e?t[0]!==e[0]||t[1]!==e[1]:t!==e}var u=t("./ElementOutput");n.prototype=Object.create(u.prototype),n.prototype.constructor=n,n.prototype.elementType="div",n.prototype.elementClass="famous-surface",n.prototype.setAttributes=function(t){for(var e in t){if("style"===e)throw new Error('Cannot set styles via "setAttributes" as it will break Famo.us.  Use "setProperties" instead.');this.attributes[e]=t[e]}this._attributesDirty=!0},n.prototype.getAttributes=function(){return this.attributes},n.prototype.setProperties=function(t){for(var e in t)this.properties[e]=t[e];return this._stylesDirty=!0,this},n.prototype.getProperties=function(){return this.properties},n.prototype.addClass=function(t){return this.classList.indexOf(t)<0&&(this.classList.push(t),this._classesDirty=!0),this},n.prototype.removeClass=function(t){var e=this.classList.indexOf(t);return e>=0&&(this._dirtyClasses.push(this.classList.splice(e,1)[0]),this._classesDirty=!0),this},n.prototype.toggleClass=function(t){var e=this.classList.indexOf(t);return e>=0?this.removeClass(t):this.addClass(t),this},n.prototype.setClasses=function(t){var e=0,i=[];for(e=0;e<this.classList.length;e++)t.indexOf(this.classList[e])<0&&i.push(this.classList[e]);for(e=0;e<i.length;e++)this.removeClass(i[e]);for(e=0;e<t.length;e++)this.addClass(t[e]);return this},n.prototype.getClassList=function(){return this.classList},n.prototype.setContent=function(t){return this.content!==t&&(this.content=t,this._contentDirty=!0),this},n.prototype.getContent=function(){return this.content},n.prototype.setOptions=function(t){return t.size&&this.setSize(t.size),t.classes&&this.setClasses(t.classes),t.properties&&this.setProperties(t.properties),t.attributes&&this.setAttributes(t.attributes),t.content&&this.setContent(t.content),this},n.prototype.setup=function(t){var e=t.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var i=0;i<this.elementClass.length;i++)e.classList.add(this.elementClass[i]);else e.classList.add(this.elementClass);e.style.display="",this.attach(e),this._opacity=null,this._currentTarget=e,this._stylesDirty=!0,this._classesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._originDirty=!0,this._transformDirty=!0},n.prototype.commit=function(t){this._currentTarget||this.setup(t.allocator);var e=this._currentTarget,i=t.size;if(this._classesDirty){s.call(this,e);for(var n=this.getClassList(),o=0;o<n.length;o++)e.classList.add(n[o]);this._classesDirty=!1,this._trueSizeCheck=!0}if(this._stylesDirty&&(r.call(this,e),this._stylesDirty=!1,this._trueSizeCheck=!0),this._attributesDirty&&(a.call(this,e),this._attributesDirty=!1,this._trueSizeCheck=!0),this.size){var h=t.size;if(i=[this.size[0],this.size[1]],void 0===i[0]&&(i[0]=h[0]),void 0===i[1]&&(i[1]=h[1]),i[0]===!0||i[1]===!0){if(i[0]===!0)if(this._trueSizeCheck||0===this._size[0]){var p=e.offsetWidth;this._size&&this._size[0]!==p&&(this._size[0]=p,this._sizeDirty=!0),i[0]=p}else this._size&&(i[0]=this._size[0]);if(i[1]===!0)if(this._trueSizeCheck||0===this._size[1]){var l=e.offsetHeight;this._size&&this._size[1]!==l&&(this._size[1]=l,this._sizeDirty=!0),i[1]=l}else this._size&&(i[1]=this._size[1]);this._trueSizeCheck=!1}}c(this._size,i)&&(this._size||(this._size=[0,0]),this._size[0]=i[0],this._size[1]=i[1],this._sizeDirty=!0),this._sizeDirty&&(this._size&&(e.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",e.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._eventOutput.emit("resize")),this._contentDirty&&(this.deploy(e),this._eventOutput.emit("deploy"),this._contentDirty=!1,this._trueSizeCheck=!0),u.prototype.commit.call(this,t)},n.prototype.cleanup=function(t){var e=0,i=this._currentTarget;this._eventOutput.emit("recall"),this.recall(i),i.style.display="none",i.style.opacity="",i.style.width="",i.style.height="",o.call(this,i),h.call(this,i);var n=this.getClassList();for(s.call(this,i),e=0;e<n.length;e++)i.classList.remove(n[e]);if(this.elementClass)if(this.elementClass instanceof Array)for(e=0;e<this.elementClass.length;e++)i.classList.remove(this.elementClass[e]);else i.classList.remove(this.elementClass);this.detach(i),this._currentTarget=null,t.deallocate(i)},n.prototype.deploy=function(t){var e=this.getContent();if(e instanceof Node){for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}else t.innerHTML=e},n.prototype.recall=function(t){for(var e=document.createDocumentFragment();t.hasChildNodes();)e.appendChild(t.firstChild);this.setContent(e)},n.prototype.getSize=function(){return this._size?this._size:this.size},n.prototype.setSize=function(t){return this.size=t?[t[0],t[1]]:null,this._sizeDirty=!0,this},i.exports=n}),define(function(t,e,i){function n(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function s(t){return Math.sqrt(n(t))}function r(t){return 0>t?-1:1}var o={};o.precision=1e-6,o.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o.multiply4x4=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]},o.multiply=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2],t[1]*e[0]+t[5]*e[1]+t[9]*e[2],t[2]*e[0]+t[6]*e[1]+t[10]*e[2],0,t[0]*e[4]+t[4]*e[5]+t[8]*e[6],t[1]*e[4]+t[5]*e[5]+t[9]*e[6],t[2]*e[4]+t[6]*e[5]+t[10]*e[6],0,t[0]*e[8]+t[4]*e[9]+t[8]*e[10],t[1]*e[8]+t[5]*e[9]+t[9]*e[10],t[2]*e[8]+t[6]*e[9]+t[10]*e[10],0,t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14],1]},o.thenMove=function(t,e){return e[2]||(e[2]=0),[t[0],t[1],t[2],0,t[4],t[5],t[6],0,t[8],t[9],t[10],0,t[12]+e[0],t[13]+e[1],t[14]+e[2],1]},o.moveThen=function(t,e){t[2]||(t[2]=0);var i=t[0]*e[0]+t[1]*e[4]+t[2]*e[8],n=t[0]*e[1]+t[1]*e[5]+t[2]*e[9],s=t[0]*e[2]+t[1]*e[6]+t[2]*e[10];return o.thenMove(e,[i,n,s])},o.translate=function(t,e,i){return void 0===i&&(i=0),[1,0,0,0,0,1,0,0,0,0,1,0,t,e,i,1]},o.thenScale=function(t,e){return[e[0]*t[0],e[1]*t[1],e[2]*t[2],0,e[0]*t[4],e[1]*t[5],e[2]*t[6],0,e[0]*t[8],e[1]*t[9],e[2]*t[10],0,e[0]*t[12],e[1]*t[13],e[2]*t[14],1]},o.scale=function(t,e,i){return void 0===i&&(i=1),void 0===e&&(e=t),[t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1]},o.rotateX=function(t){var e=Math.cos(t),i=Math.sin(t);return[1,0,0,0,0,e,i,0,0,-i,e,0,0,0,0,1]},o.rotateY=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,0,-i,0,0,1,0,0,i,0,e,0,0,0,0,1]},o.rotateZ=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,i,0,0,-i,e,0,0,0,0,1,0,0,0,0,1]},o.rotate=function(t,e,i){var n=Math.cos(t),s=Math.sin(t),r=Math.cos(e),o=Math.sin(e),a=Math.cos(i),h=Math.sin(i),c=[r*a,n*h+s*o*a,s*h-n*o*a,0,-r*h,n*a-s*o*h,s*a+n*o*h,0,o,-s*r,n*r,0,0,0,0,1];return c},o.rotateAxis=function(t,e){var i=Math.sin(e),n=Math.cos(e),s=1-n,r=t[0]*t[0]*s,o=t[0]*t[1]*s,a=t[0]*t[2]*s,h=t[1]*t[1]*s,c=t[1]*t[2]*s,u=t[2]*t[2]*s,p=t[0]*i,l=t[1]*i,d=t[2]*i,f=[r+n,o+d,a-l,0,o-d,h+n,c+p,0,a+l,c-p,u+n,0,0,0,0,1];return f},o.aboutOrigin=function(t,e){var i=t[0]-(t[0]*e[0]+t[1]*e[4]+t[2]*e[8]),n=t[1]-(t[0]*e[1]+t[1]*e[5]+t[2]*e[9]),s=t[2]-(t[0]*e[2]+t[1]*e[6]+t[2]*e[10]);return o.thenMove(e,[i,n,s])},o.skew=function(t,e,i){return[1,Math.tan(e),0,0,Math.tan(i),1,0,0,0,Math.tan(t),1,0,0,0,0,1]},o.skewX=function(t){return[1,0,0,0,Math.tan(t),1,0,0,0,0,1,0,0,0,0,1]},o.skewY=function(t){return[1,Math.tan(t),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},o.perspective=function(t){return[1,0,0,0,0,1,0,0,0,0,1,-1/t,0,0,0,1]},o.getTranslate=function(t){return[t[12],t[13],t[14]]},o.inverse=function(t){var e=t[5]*t[10]-t[6]*t[9],i=t[4]*t[10]-t[6]*t[8],n=t[4]*t[9]-t[5]*t[8],s=t[1]*t[10]-t[2]*t[9],r=t[0]*t[10]-t[2]*t[8],o=t[0]*t[9]-t[1]*t[8],a=t[1]*t[6]-t[2]*t[5],h=t[0]*t[6]-t[2]*t[4],c=t[0]*t[5]-t[1]*t[4],u=t[0]*e-t[1]*i+t[2]*n,p=1/u,l=[p*e,-p*s,p*a,0,-p*i,p*r,-p*h,0,p*n,-p*o,p*c,0,0,0,0,1];return l[12]=-t[12]*l[0]-t[13]*l[4]-t[14]*l[8],l[13]=-t[12]*l[1]-t[13]*l[5]-t[14]*l[9],l[14]=-t[12]*l[2]-t[13]*l[6]-t[14]*l[10],l},o.transpose=function(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},o.interpret=function(t){var e=[t[0],t[1],t[2]],i=r(e[0]),a=s(e),h=[e[0]+i*a,e[1],e[2]],c=2/n(h);if(c>=1/0)return{translate:o.getTranslate(t),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];u[0]=1-c*h[0]*h[0],u[5]=1-c*h[1]*h[1],u[10]=1-c*h[2]*h[2],u[1]=-c*h[0]*h[1],u[2]=-c*h[0]*h[2],u[6]=-c*h[1]*h[2],u[4]=u[1],u[8]=u[2],u[9]=u[6];var p=o.multiply(u,t),l=[p[5],p[6]],d=r(l[0]),f=s(l),g=[l[0]+d*f,l[1]],_=2/n(g),m=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];m[5]=1-_*g[0]*g[0],m[10]=1-_*g[1]*g[1],m[6]=-_*g[0]*g[1],m[9]=m[6];var y=o.multiply(m,u),v=o.multiply(y,t),O=o.scale(v[0]<0?-1:1,v[5]<0?-1:1,v[10]<0?-1:1);v=o.multiply(v,O),y=o.multiply(O,y);var b={};return b.translate=o.getTranslate(t),b.rotate=[Math.atan2(-y[6],y[10]),Math.asin(y[2]),Math.atan2(-y[1],y[0])],b.rotate[0]||(b.rotate[0]=0,b.rotate[2]=Math.atan2(y[4],y[5])),b.scale=[v[0],v[5],v[10]],b.skew=[Math.atan2(v[9],b.scale[2]),Math.atan2(v[8],b.scale[2]),Math.atan2(v[4],b.scale[0])],Math.abs(b.rotate[0])+Math.abs(b.rotate[2])>1.5*Math.PI&&(b.rotate[1]=Math.PI-b.rotate[1],b.rotate[1]>Math.PI&&(b.rotate[1]-=2*Math.PI),b.rotate[1]<-Math.PI&&(b.rotate[1]+=2*Math.PI),b.rotate[0]<0?b.rotate[0]+=Math.PI:b.rotate[0]-=Math.PI,b.rotate[2]<0?b.rotate[2]+=Math.PI:b.rotate[2]-=Math.PI),b},o.average=function(t,e,i){i=void 0===i?.5:i;for(var n=o.interpret(t),s=o.interpret(e),r={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},a=0;3>a;a++)r.translate[a]=(1-i)*n.translate[a]+i*s.translate[a],r.rotate[a]=(1-i)*n.rotate[a]+i*s.rotate[a],r.scale[a]=(1-i)*n.scale[a]+i*s.scale[a],r.skew[a]=(1-i)*n.skew[a]+i*s.skew[a];return o.build(r)},o.build=function(t){var e=o.scale(t.scale[0],t.scale[1],t.scale[2]),i=o.skew(t.skew[0],t.skew[1],t.skew[2]),n=o.rotate(t.rotate[0],t.rotate[1],t.rotate[2]);return o.thenMove(o.multiply(o.multiply(n,i),e),t.translate)},o.equals=function(t,e){return!o.notEquals(t,e)},o.notEquals=function(t,e){return t===e?!1:!(t&&e)||t[12]!==e[12]||t[13]!==e[13]||t[14]!==e[14]||t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[4]!==e[4]||t[5]!==e[5]||t[6]!==e[6]||t[8]!==e[8]||t[9]!==e[9]||t[10]!==e[10]},o.normalizeRotation=function(t){var e=t.slice(0);for((e[0]===.5*Math.PI||e[0]===.5*-Math.PI)&&(e[0]=-e[0],e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]>.5*Math.PI&&(e[0]=e[0]-Math.PI,e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]<.5*-Math.PI&&(e[0]=e[0]+Math.PI,e[1]=-Math.PI-e[1],e[2]-=Math.PI);e[1]<-Math.PI;)e[1]+=2*Math.PI;
for(;e[1]>=Math.PI;)e[1]-=2*Math.PI;for(;e[2]<-Math.PI;)e[2]+=2*Math.PI;for(;e[2]>=Math.PI;)e[2]-=2*Math.PI;return e},o.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],o.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],i.exports=o}),define(function(t,e,i){function n(t){this._node=new o,this._eventInput=new s,this._eventOutput=new s,s.setInputHandler(this,this._eventInput),s.setOutputHandler(this,this._eventOutput),this.options=a.clone(this.constructor.DEFAULT_OPTIONS||n.DEFAULT_OPTIONS),this._optionsManager=new r(this.options),t&&this.setOptions(t)}var s=t("./EventHandler"),r=t("./OptionsManager"),o=t("./RenderNode"),a=t("../utilities/Utility");n.DEFAULT_OPTIONS={},n.prototype.getOptions=function(t){return this._optionsManager.getOptions(t)},n.prototype.setOptions=function(t){this._optionsManager.patch(t)},n.prototype.add=function(){return this._node.add.apply(this._node,arguments)},n.prototype._add=n.prototype.add,n.prototype.render=function(){return this._node.render()},n.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},i.exports=n}),define(function(t,e,i){function n(t){t||(t=[]),t instanceof Array&&(t={array:t}),this._=null,this.index=t.index||0,t.array?this._=new this.constructor.Backing(t.array):t._&&(this._=t._),this.index===this._.firstIndex&&(this._.firstNode=this),this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),void 0!==t.loop&&(this._.loop=t.loop),void 0!==t.trackSize&&(this._.trackSize=t.trackSize),this._previousNode=null,this._nextNode=null}n.Backing=function(t){this.array=t,this.firstIndex=0,this.loop=!1,this.firstNode=null,this.lastNode=null,this.cumulativeSizes=[[0,0]],this.sizeDirty=!0,this.trackSize=!1},n.Backing.prototype.getValue=function(t){var e=t-this.firstIndex;return 0>e||e>=this.array.length?null:this.array[e]},n.Backing.prototype.setValue=function(t,e){this.array[t-this.firstIndex]=e},n.Backing.prototype.getSize=function(t){return this.cumulativeSizes[t]},n.Backing.prototype.calculateSize=function(t){t=t||this.array.length;for(var e=[0,0],i=0;t>i;i++){var n=this.array[i].getSize();if(!n)return void 0;void 0!==e[0]&&(void 0===n[0]?e[0]=void 0:e[0]+=n[0]),void 0!==e[1]&&(void 0===n[1]?e[1]=void 0:e[1]+=n[1]),this.cumulativeSizes[i+1]=e.slice()}return this.sizeDirty=!1,e},n.Backing.prototype.reindex=function(t,e,i){if(this.array[0]){for(var n=0,s=this.firstIndex,r=i-e,o=this.firstNode;t-1>s;)o=o.getNext(),s++;var a=o;for(n=0;e>n;n++)o=o.getNext(),o&&(o._previousNode=a);var h=o?o.getNext():null;for(a._nextNode=null,o=a,n=0;i>n;n++)o=o.getNext();if(s+=i,o!==h&&(o._nextNode=h,h&&(h._previousNode=o)),h)for(o=h,s++;o&&s<this.array.length+this.firstIndex;)o._nextNode?o.index+=r:o.index=s,o=o.getNext(),s++;this.trackSize&&(this.sizeDirty=!0)}},n.prototype.getPrevious=function(){var t=this._.array.length;return t?this.index===this._.firstIndex?this._.loop?(this._previousNode=this._.lastNode||new this.constructor({_:this._,index:this._.firstIndex+t-1}),this._previousNode._nextNode=this):this._previousNode=null:this._previousNode||(this._previousNode=new this.constructor({_:this._,index:this.index-1}),this._previousNode._nextNode=this):this._previousNode=null,this._previousNode},n.prototype.getNext=function(){var t=this._.array.length;return t?this.index===this._.firstIndex+t-1?this._.loop?(this._nextNode=this._.firstNode||new this.constructor({_:this._,index:this._.firstIndex}),this._nextNode._previousNode=this):this._nextNode=null:this._nextNode||(this._nextNode=new this.constructor({_:this._,index:this.index+1}),this._nextNode._previousNode=this):this._nextNode=null,this._nextNode},n.prototype.indexOf=function(t){return this._.array.indexOf(t)},n.prototype.getIndex=function(){return this.index},n.prototype.toString=function(){return""+this.index},n.prototype.unshift=function(){this._.array.unshift.apply(this._.array,arguments),this._.firstIndex-=arguments.length,this._.trackSize&&(this._.sizeDirty=!0)},n.prototype.push=function(){this._.array.push.apply(this._.array,arguments),this._.trackSize&&(this._.sizeDirty=!0)},n.prototype.splice=function(t,e){var i=Array.prototype.slice.call(arguments,2);this._.array.splice.apply(this._.array,[t-this._.firstIndex,e].concat(i)),this._.reindex(t,e,i.length)},n.prototype.swap=function(t){var e=t.get(),i=this.get();this._.setValue(this.index,e),this._.setValue(t.index,i);var n=this._previousNode,s=this._nextNode,r=this.index,o=t._previousNode,a=t._nextNode,h=t.index;this.index=h,this._previousNode=o===this?t:o,this._previousNode&&(this._previousNode._nextNode=this),this._nextNode=a===this?t:a,this._nextNode&&(this._nextNode._previousNode=this),t.index=r,t._previousNode=n===t?this:n,t._previousNode&&(t._previousNode._nextNode=t),t._nextNode=s===t?this:s,t._nextNode&&(t._nextNode._previousNode=t),this.index===this._.firstIndex?this._.firstNode=this:this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),t.index===this._.firstIndex?this._.firstNode=t:t.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=t),this._.trackSize&&(this._.sizeDirty=!0)},n.prototype.get=function(){return this._.getValue(this.index)},n.prototype.getSize=function(){var t=this.get();return t?t.getSize():null},n.prototype.render=function(){this._.trackSize&&this._.sizeDirty&&this._.calculateSize();var t=this.get();return t?t.render.apply(t,arguments):null},i.exports=n}),define(function(t,e,i){function n(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS||n.DEFAULT_OPTIONS),this._optionsManager=new o(this.options),t&&this.setOptions(t),this._eventInput=new r,this._eventOutput=new r,r.setInputHandler(this,this._eventInput),r.setOutputHandler(this,this._eventOutput),this._id=s.register(this)}var s=t("../core/Entity"),r=(t("../core/Transform"),t("../core/EventHandler")),o=t("../core/OptionsManager");n.DEFAULT_OPTIONS={},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.getOptions=function(t){return this._optionsManager.getOptions(t)},n.prototype.render=function(){return this._id},n.prototype.commit=function(){},i.exports=n}),define(function(t,e,i){function n(){u.apply(this,arguments),this.state=new h(0),this._isOpen=!1,this.setOutputFunction(function(t,e,i){var n=s.call(this),r=this.options.direction===c.Direction.X?o.translate(n*e,0,.001*(n-1)*e):o.translate(0,n*e,.001*(n-1)*e),a=t.render();if(this.options.stackRotation){var h=this.options.stackRotation*i*(1-n);a={transform:o.rotateZ(h),origin:[.5,.5],target:a}}return{transform:r,size:t.getSize(),target:a}})}function s(t){return t?this._isOpen?1:0:this.state.get()}function r(t,e,i){this.state.halt(),this.state.set(t,e,i)}var o=t("../core/Transform"),a=t("../core/OptionsManager"),h=t("../transitions/Transitionable"),c=t("../utilities/Utility"),u=t("./SequentialLayout");n.prototype=Object.create(u.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS=a.patch(u.DEFAULT_OPTIONS,{transition:{curve:"easeOutBounce",duration:500},stackRotation:0}),n.prototype.getSize=function(){var t=u.prototype.getSize.apply(this,arguments),e=this._items?this._items.get().getSize():[0,0];e||(e=[0,0]);var i=s.call(this),n=1-i;return[e[0]*n+t[0]*i,e[1]*n+t[1]*i]},n.prototype.isOpen=function(){return this._isOpen},n.prototype.open=function(t){this._isOpen=!0,r.call(this,1,this.options.transition,t)},n.prototype.close=function(t){this._isOpen=!1,r.call(this,0,this.options.transition,t)},n.prototype.toggle=function(t){this._isOpen?this.close(t):this.open(t)},i.exports=n}),define(function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new p(this.options),t&&this.setOptions(t),this._position=new l(0),this._direction=s(this.options.side),this._orientation=r(this.options.side),this._isOpen=!1,this._cachedLength=0,this.drawer=new c,this.content=new c,this._eventInput=new d,this._eventOutput=new d,d.setInputHandler(this,this._eventInput),d.setOutputHandler(this,this._eventOutput),this._eventInput.on("update",a.bind(this)),this._eventInput.on("end",h.bind(this))}function s(t){var e=n.SIDES;return t===e.LEFT||t===e.RIGHT?f:g}function r(t){var e=n.SIDES;return t===e.LEFT||t===e.TOP?1:-1}function o(t){var e,i=this.options;if(i.drawerLength)e=i.drawerLength;else{var n=t.getSize();e=n?n[this._direction]:i.drawerLength}return this._orientation*e}function a(t){var e,i,n=this.getPosition()+t.delta;this._cachedLength=o.call(this,this.drawer),1===this._orientation?(e=0,i=this._cachedLength):(e=this._cachedLength,i=0),n>i?n=i:e>n&&(n=e),this.setPosition(n)}function h(t){var e=t.velocity,i=this._orientation*this.getPosition(),n=this.options,s=this._orientation*this._cachedLength,r=n.positionThreshold||s/2,o=n.velocityThreshold;if(n.transition instanceof Object&&(n.transition.velocity=t.velocity),0===i)return void(this._isOpen=!1);if(i===s)return void(this._isOpen=!0);var a=Math.abs(e)>o||!this._isOpen&&i>r||this._isOpen&&r>i;a?this.toggle():this.reset()}var c=t("../core/RenderNode"),u=t("../core/Transform"),p=t("../core/OptionsManager"),l=t("../transitions/Transitionable"),d=t("../core/EventHandler"),f=0,g=1;n.SIDES={LEFT:0,TOP:1,RIGHT:2,BOTTOM:3},n.DEFAULT_OPTIONS={side:n.SIDES.LEFT,drawerLength:0,velocityThreshold:0,positionThreshold:0,transition:!0},n.prototype.setOptions=function(t){this._optionsManager.setOptions(t),void 0!==t.side&&(this._direction=s(t.side),this._orientation=r(t.side))},n.prototype.open=function(t,e){t instanceof Function&&(e=t),void 0===t&&(t=this.options.transition),this._cachedLength=o.call(this,this.drawer),this.setPosition(this._cachedLength,t,e),this._isOpen||(this._isOpen=!0,this._eventOutput.emit("open"))},n.prototype.close=function(t,e){t instanceof Function&&(e=t),void 0===t&&(t=this.options.transition),this.setPosition(0,t,e),this._isOpen&&(this._isOpen=!1,this._eventOutput.emit("close"))},n.prototype.setPosition=function(t,e,i){this._position.isActive()&&this._position.halt(),this._position.set(t,e,i)},n.prototype.getPosition=function(){return this._position.get()},n.prototype.setProgress=function(t,e,i){return this._position.set(t*this._cachedLength,e,i)},n.prototype.getProgress=function(){return this._position.get()/this._cachedLength},n.prototype.toggle=function(t){this._isOpen?this.close(t):this.open(t)},n.prototype.reset=function(t){this._isOpen?this.open(t):this.close(t)},n.prototype.isOpen=function(){return this._isOpen},n.prototype.render=function(){var t=this.getPosition();(!this._isOpen&&0>t&&1===this._orientation||t>0&&-1===this._orientation)&&(t=0,this.setPosition(t));var e=this._direction===f?u.translate(t,0,0):u.translate(0,t,0);return[{transform:u.behind,target:this.drawer.render()},{transform:e,target:this.content.render()}]},i.exports=n}),define(function(t,e,i){function n(t){this._currentTarget=null,this._size=[void 0,void 0],this._controller=new c(t),this._controller.inTransformFrom(r.create(s.bind(this,1e-4))),this._controller.outTransformFrom(r.create(s.bind(this,-1e-4))),this._eventInput=new a,a.setInputHandler(this,this._eventInput),this._entityId=o.register(this),t&&this.setOptions(t)}function s(t,e){return h.translate(this._size[0]*(1-e),0,t*(1-e))}var r=t("../transitions/CachedMap"),o=t("../core/Entity"),a=t("../core/EventHandler"),h=t("../core/Transform"),c=t("./RenderController");n.prototype.show=function(t){this._currentTarget&&this._eventInput.unpipe(this._currentTarget),this._currentTarget=t,this._currentTarget&&this._currentTarget.trigger&&this._eventInput.pipe(this._currentTarget),this._controller.show.apply(this._controller,arguments)},n.prototype.setOptions=function(t){this._controller.setOptions(t)},n.prototype.render=function(){return this._entityId},n.prototype.commit=function(t){return this._size[0]=t.size[0],this._size[1]=t.size[1],{transform:t.transform,opacity:t.opacity,origin:t.origin,size:t.size,target:this._controller.render()}},i.exports=n}),define(function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this.optionsManager=new h(this.options),t&&this.setOptions(t),this.id=o.register(this),this._ratios=new u(this.options.ratios),this._nodes=[],this._size=[0,0],this._cachedDirection=null,this._cachedLengths=[],this._cachedTransforms=null,this._ratiosDirty=!1,this._eventOutput=new c,c.setOutputHandler(this,this._eventOutput)}function s(t,e,i){var s,r,o,h,c=0,u=e,p=0;for(this._cachedLengths=[],this._cachedTransforms=[],h=0;h<t.length;h++)r=t[h],o=this._nodes[h],"number"!=typeof r?u-=o.getSize()[i]||0:p+=r;for(h=0;h<t.length;h++)o=this._nodes[h],r=t[h],e="number"==typeof r?u*r/p:o.getSize()[i],s=i===n.DIRECTION_X?a.translate(c,0,0):a.translate(0,c,0),this._cachedTransforms.push(s),this._cachedLengths.push(e),c+=e}function r(t,e){for(var i=0;i<t.length;i++)if("number"!=typeof t[i]&&this._nodes[i].getSize()[e]!==this._cachedLengths[i])return!0;return!1}var o=t("../core/Entity"),a=t("../core/Transform"),h=t("../core/OptionsManager"),c=t("../core/EventHandler"),u=t("../transitions/Transitionable");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.DEFAULT_OPTIONS={direction:n.DIRECTION_X,transition:!1,ratios:[]},n.prototype.render=function(){return this.id},n.prototype.setOptions=function(t){this.optionsManager.setOptions(t)},n.prototype.sequenceFrom=function(t){if(this._nodes=t,0===this._ratios.get().length){for(var e=[],i=0;i<this._nodes.length;i++)e.push(1);this.setRatios(e)}},n.prototype.setRatios=function(t,e,i){void 0===e&&(e=this.options.transition);var n=this._ratios;0===n.get().length&&(e=void 0),n.isActive()&&n.halt(),n.set(t,e,i),this._ratiosDirty=!0},n.prototype.getSize=function(){return this._size},n.prototype.commit=function(t){var e,i=t.size,n=t.transform,o=t.origin,h=t.opacity,c=this._ratios.get(),u=this.options.direction,p=i[u];(p!==this._size[u]||this._ratiosDirty||this._ratios.isActive()||u!==this._cachedDirection||r.call(this,c,u))&&(s.call(this,c,p,u),p!==this._size[u]&&(this._size[0]=i[0],this._size[1]=i[1]),u!==this._cachedDirection&&(this._cachedDirection=u),this._ratiosDirty&&(this._ratiosDirty=!1));for(var l=[],d=0;d<c.length;d++)e=[void 0,void 0],p=this._cachedLengths[d],e[u]=p,l.push({transform:this._cachedTransforms[d],size:e,target:this._nodes[d].render()});return i&&0!==o[0]&&0!==o[1]&&(n=a.moveThen([-i[0]*o[0],-i[1]*o[1],0],n)),{transform:n,size:i,opacity:h,target:l}},i.exports=n}),define(function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new o(this.options),t&&this.setOptions(t),this.angle=new r(0),this.frontNode=void 0,this.backNode=void 0,this.flipped=!1}var s=t("../core/Transform"),r=t("../transitions/Transitionable"),o=(t("../core/RenderNode"),t("../core/OptionsManager"));n.DIRECTION_X=0,n.DIRECTION_Y=1;var a=1;n.DEFAULT_OPTIONS={transition:!0,direction:n.DIRECTION_X},n.prototype.flip=function(t,e){var i=this.flipped?0:Math.PI;this.setAngle(i,t,e),this.flipped=!this.flipped},n.prototype.setAngle=function(t,e,i){void 0===e&&(e=this.options.transition),this.angle.isActive()&&this.angle.halt(),this.angle.set(t,e,i)},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.setFront=function(t){this.frontNode=t},n.prototype.setBack=function(t){this.backNode=t},n.prototype.render=function(){var t,e,i=this.angle.get();this.options.direction===n.DIRECTION_X?(t=s.rotateY(i),e=s.rotateY(i+Math.PI)):(t=s.rotateX(i),e=s.rotateX(i+Math.PI));var r=[];return this.frontNode&&r.push({transform:t,target:this.frontNode.render()}),this.backNode&&r.push({transform:s.moveThen([0,0,a],e),target:this.backNode.render()}),r},i.exports=n}),define(function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this.optionsManager=new l(this.options),t&&this.setOptions(t),this.id=a.register(this),this._modifiers=[],this._states=[],this._contextSizeCache=[0,0],this._dimensionsCache=[0,0],this._activeCount=0,this._eventOutput=new u,u.setOutputHandler(this,this._eventOutput)}function s(t,e,i){var n=[t[0],t[1]];n[0]-=this.options.gutterSize[0]*(e-1),n[1]-=this.options.gutterSize[1]*(i-1);for(var s,a=Math.round(n[1]/i),h=Math.round(n[0]/e),c=0,u=0,p=0;i>p;p++){s=0;for(var l=0;e>l;l++)void 0===this._modifiers[u]?r.call(this,u,[h,a],[s,c,0],1):o.call(this,u,[h,a],[s,c,0],1),u++,s+=h+this.options.gutterSize[0];c+=a+this.options.gutterSize[1]}for(this._dimensionsCache=[this.options.dimensions[0],this.options.dimensions[1]],this._contextSizeCache=[t[0],t[1]],this._activeCount=i*e,p=this._activeCount;p<this._modifiers.length;p++)o.call(this,p,[Math.round(h),Math.round(a)],[0,0],0);this._eventOutput.emit("reflow")}function r(t,e,i,n){var s={transform:new f(h.translate.apply(null,i)),opacity:new d(n),size:new d(e)},r=new p({transform:s.transform,opacity:s.opacity,size:s.size});this._states[t]=s,this._modifiers[t]=r}function o(t,e,i,n){var s=this._states[t],r=s.size,o=s.opacity,a=s.transform,h=this.options.transition;a.halt(),o.halt(),r.halt(),a.setTranslate(i,h),r.set(e,h),o.set(n,h)}var a=t("../core/Entity"),h=(t("../core/RenderNode"),t("../core/Transform")),c=t("../core/ViewSequence"),u=t("../core/EventHandler"),p=t("../core/Modifier"),l=t("../core/OptionsManager"),d=t("../transitions/Transitionable"),f=t("../transitions/TransitionableTransform");n.DEFAULT_OPTIONS={dimensions:[1,1],transition:!1,gutterSize:[0,0]},n.prototype.render=function(){return this.id},n.prototype.setOptions=function(t){return this.optionsManager.setOptions(t)},n.prototype.sequenceFrom=function(t){t instanceof Array&&(t=new c(t)),this.sequence=t},n.prototype.getSize=function(){return this._contextSizeCache},n.prototype.commit=function(t){var e=t.transform,i=t.opacity,n=t.origin,r=t.size,o=this.options.dimensions[0],a=this.options.dimensions[1];(r[0]!==this._contextSizeCache[0]||r[1]!==this._contextSizeCache[1]||o!==this._dimensionsCache[0]||a!==this._dimensionsCache[1])&&s.call(this,r,o,a);for(var c=this.sequence,u=[],p=0;c&&p<this._modifiers.length;){var l=c.get(),d=this._modifiers[p];p>=this._activeCount&&this._states[p].opacity.isActive()&&(this._modifiers.splice(p,1),this._states.splice(p,1)),l&&u.push(d.modify({origin:n,target:l.render()})),c=c.getNext(),p++}return r&&(e=h.moveThen([-r[0]*n[0],-r[1]*n[1],0],e)),{transform:e,opacity:i,size:r,target:u}},i.exports=n}),define(function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new u(this.options),t&&this.setOptions(t),this._entityId=a.register(this),this.header=new h,this.footer=new h,this.content=new h}function s(t,e){var i=t.getSize();return i?i[this.options.direction]:e}function r(t){return this.options.direction===n.DIRECTION_X?c.translate(t,0,0):c.translate(0,t,0)}function o(t,e){return this.options.direction===n.DIRECTION_X?[t,e[1]]:[e[0],t]}var a=t("../core/Entity"),h=t("../core/RenderNode"),c=t("../core/Transform"),u=t("../core/OptionsManager");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.DEFAULT_OPTIONS={direction:n.DIRECTION_Y,headerSize:void 0,footerSize:void 0,defaultHeaderSize:0,defaultFooterSize:0},n.prototype.render=function(){return this._entityId},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.commit=function(t){var e=t.transform,i=t.origin,n=t.size,a=t.opacity,h=void 0!==this.options.headerSize?this.options.headerSize:s.call(this,this.header,this.options.defaultHeaderSize),u=void 0!==this.options.footerSize?this.options.footerSize:s.call(this,this.footer,this.options.defaultFooterSize),p=n[this.options.direction]-h-u;n&&(e=c.moveThen([-n[0]*i[0],-n[1]*i[1],0],e));var l=[{size:o.call(this,h,n),target:this.header.render()},{transform:r.call(this,h),size:o.call(this,p,n),target:this.content.render()},{transform:r.call(this,h+p),size:o.call(this,u,n),target:this.footer.render()}];return{transform:e,opacity:a,size:n,target:l}},i.exports=n}),define(function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),t&&this.setOptions(t),this._showing=!1,this.nodes=[],this.transforms=[],this.states=[]}var s=t("../core/Transform"),r=t("../core/Modifier"),o=t("../core/RenderNode"),a=t("../utilities/Utility"),h=t("../core/OptionsManager"),c=t("../transitions/Transitionable"),u=t("../transitions/TransitionableTransform");n.DEFAULT_OPTIONS={inTransform:s.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],inAlign:[.5,.5],outTransform:s.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],outAlign:[.5,.5],showTransform:s.identity,showOpacity:1,showOrigin:[.5,.5],showAlign:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.show=function(t,e,i){if(!t)return this.hide(i);if(e instanceof Function&&(i=e,e=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,t,e,i));this.hide()}this._showing=!0;var n={transform:new u(this.options.inTransform),origin:new c(this.options.inOrigin),align:new c(this.options.inAlign),opacity:new c(this.options.inOpacity)},s=new r({transform:n.transform,opacity:n.opacity,origin:n.origin,align:n.align}),h=new o;h.add(s).add(t),this.nodes.push(h),this.states.push(n),this.transforms.push(s);var p=i?a.after(3,i):void 0;e||(e=this.options.inTransition),n.transform.set(this.options.showTransform,e,p),n.opacity.set(this.options.showOpacity,e,p),n.origin.set(this.options.showOrigin,e,p),n.align.set(this.options.showAlign,e,p)},n.prototype.hide=function(t,e){if(this._showing){this._showing=!1,t instanceof Function&&(e=t,t=void 0);var i=this.nodes[this.nodes.length-1],n=this.transforms[this.transforms.length-1],s=this.states[this.states.length-1],r=a.after(3,function(){this.nodes.splice(this.nodes.indexOf(i),1),this.states.splice(this.states.indexOf(s),1),this.transforms.splice(this.transforms.indexOf(n),1),e&&e.call(this)}.bind(this));t||(t=this.options.outTransition),s.transform.set(this.options.outTransform,t,r),s.opacity.set(this.options.outOpacity,t,r),s.origin.set(this.options.outOrigin,t,r),s.align.set(this.options.outAlign,t,r)}},n.prototype.render=function(){for(var t=[],e=0;e<this.nodes.length;e++)t.push(this.nodes[e].render());return t},i.exports=n}),define(function(t,e,i){function n(){c.apply(this,arguments),this._showing=-1,this._outgoingRenderables=[],this._nextRenderable=null,this._renderables=[],this._nodes=[],this._modifiers=[],this._states=[],this.inTransformMap=n.DefaultMap.transform,this.inOpacityMap=n.DefaultMap.opacity,this.inOriginMap=n.DefaultMap.origin,this.inAlignMap=n.DefaultMap.align,this.outTransformMap=n.DefaultMap.transform,this.outOpacityMap=n.DefaultMap.opacity,this.outOriginMap=n.DefaultMap.origin,this.outAlignMap=n.DefaultMap.align,this._output=[]}function s(t,e){return t(e.get())}var r=t("../core/Modifier"),o=t("../core/RenderNode"),a=t("../core/Transform"),h=t("../transitions/Transitionable"),c=t("../core/View");n.prototype=Object.create(c.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={inTransition:!0,outTransition:!0,overlap:!0},n.DefaultMap={transform:function(){return a.identity},opacity:function(t){return t},origin:null,align:null},n.prototype.inTransformFrom=function(t){if(t instanceof Function)this.inTransformMap=t;else{if(!t||!t.get)throw new Error("inTransformFrom takes only function or getter object");this.inTransformMap=t.get.bind(t)}return this},n.prototype.inOpacityFrom=function(t){if(t instanceof Function)this.inOpacityMap=t;else{if(!t||!t.get)throw new Error("inOpacityFrom takes only function or getter object");this.inOpacityMap=t.get.bind(t)}return this},n.prototype.inOriginFrom=function(t){if(t instanceof Function)this.inOriginMap=t;else{if(!t||!t.get)throw new Error("inOriginFrom takes only function or getter object");this.inOriginMap=t.get.bind(t)}return this},n.prototype.inAlignFrom=function(t){if(t instanceof Function)this.inAlignMap=t;else{if(!t||!t.get)throw new Error("inAlignFrom takes only function or getter object");this.inAlignMap=t.get.bind(t)}return this},n.prototype.outTransformFrom=function(t){if(t instanceof Function)this.outTransformMap=t;else{if(!t||!t.get)throw new Error("outTransformFrom takes only function or getter object");this.outTransformMap=t.get.bind(t)}return this},n.prototype.outOpacityFrom=function(t){if(t instanceof Function)this.outOpacityMap=t;else{if(!t||!t.get)throw new Error("outOpacityFrom takes only function or getter object");this.outOpacityMap=t.get.bind(t)}return this},n.prototype.outOriginFrom=function(t){if(t instanceof Function)this.outOriginMap=t;else{if(!t||!t.get)throw new Error("outOriginFrom takes only function or getter object");this.outOriginMap=t.get.bind(t)}return this},n.prototype.outAlignFrom=function(t){if(t instanceof Function)this.outAlignMap=t;else{if(!t||!t.get)throw new Error("outAlignFrom takes only function or getter object");this.outAlignMap=t.get.bind(t)}return this},n.prototype.show=function(t,e,i){if(!t)return this.hide(i);if(e instanceof Function&&(i=e,e=null),this._showing>=0){if(!this.options.overlap)return void(this._nextRenderable?this._nextRenderable=t:(this._nextRenderable=t,this.hide(function(){this._nextRenderable===t&&this.show(this._nextRenderable,i),this._nextRenderable=null})));this.hide()}var n=null,a=this._renderables.indexOf(t);if(a>=0){this._showing=a,n=this._states[a],n.halt();var c=this._outgoingRenderables.indexOf(t);c>=0&&this._outgoingRenderables.splice(c,1)}else{n=new h(0);var u=new r({transform:this.inTransformMap?s.bind(this,this.inTransformMap,n):null,opacity:this.inOpacityMap?s.bind(this,this.inOpacityMap,n):null,origin:this.inOriginMap?s.bind(this,this.inOriginMap,n):null,align:this.inAlignMap?s.bind(this,this.inAlignMap,n):null}),p=new o;p.add(u).add(t),this._showing=this._nodes.length,this._nodes.push(p),this._modifiers.push(u),this._states.push(n),this._renderables.push(t)}e||(e=this.options.inTransition),n.set(1,e,i)},n.prototype.hide=function(t,e){if(!(this._showing<0)){var i=this._showing;this._showing=-1,t instanceof Function&&(e=t,t=void 0);var n=this._nodes[i],r=this._modifiers[i],o=this._states[i],a=this._renderables[i];r.transformFrom(this.outTransformMap?s.bind(this,this.outTransformMap,o):null),r.opacityFrom(this.outOpacityMap?s.bind(this,this.outOpacityMap,o):null),r.originFrom(this.outOriginMap?s.bind(this,this.outOriginMap,o):null),r.alignFrom(this.outAlignMap?s.bind(this,this.outAlignMap,o):null),this._outgoingRenderables.indexOf(a)<0&&this._outgoingRenderables.push(a),t||(t=this.options.outTransition),o.halt(),o.set(0,t,function(t,i,n,s){if(this._outgoingRenderables.indexOf(s)>=0){var r=this._nodes.indexOf(t);this._nodes.splice(r,1),this._modifiers.splice(r,1),this._states.splice(r,1),this._renderables.splice(r,1),this._outgoingRenderables.splice(this._outgoingRenderables.indexOf(s),1),this._showing>=r&&this._showing--}e&&e.call(this)}.bind(this,n,r,o,a))}},n.prototype.render=function(){var t=this._output;t.length>this._nodes.length&&t.splice(this._nodes.length);for(var e=0;e<this._nodes.length;e++)t[e]=this._nodes[e].render();return t},i.exports=n}),define(function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new a(this.options),t&&this.setOptions(t),this.container=new s(this.options.container),this.scrollview=new o(this.options.scrollview),this.container.add(this.scrollview),this._eventInput=new r,r.setInputHandler(this,this._eventInput),this._eventInput.pipe(this.scrollview),this._eventOutput=new r,r.setOutputHandler(this,this._eventOutput),this.container.pipe(this._eventOutput),this.scrollview.pipe(this._eventOutput)}var s=t("../surfaces/ContainerSurface"),r=t("../core/EventHandler"),o=t("./Scrollview"),a=(t("../utilities/Utility"),t("../core/OptionsManager"));n.DEFAULT_OPTIONS={container:{properties:{overflow:"hidden"}},scrollview:{}},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.sequenceFrom=function(){return this.scrollview.sequenceFrom.apply(this.scrollview,arguments)},n.prototype.getSize=function(){return this.container.getSize.apply(this.container,arguments)},n.prototype.render=function(){return this.container.render()},i.exports=n}),define(function(t,e,i){function n(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),this._optionsManager=new u(this.options),t&&this._optionsManager.setOptions(t),this._node=null,this._position=0,this._positionOffset=0,this._positionGetter=null,this._outputFunction=null,this._masterOutputFunction=null,this.outputFrom(),this._onEdge=0,this.group=new c,this.group.add({render:a.bind(this)}),this._entityId=h.register(this),this._size=[void 0,void 0],this._contextSize=[void 0,void 0],this._eventInput=new f,this._eventOutput=new f,f.setInputHandler(this,this._eventInput),f.setOutputHandler(this,this._eventOutput)}function s(t){t||(t=this._contextSize);var e=this.options.direction;return void 0===t[e]?this._contextSize[e]:t[e]}function r(t,e,i){var n=t.getSize?t.getSize():this._contextSize,r=this._outputFunction(e);return i.push({transform:r,target:t.render()}),s.call(this,n)}function o(){return void 0!==this.options.clipSize?this.options.clipSize:this._contextSize[this.options.direction]>this.getCumulativeSize()[this.options.direction]?s.call(this,this.getCumulativeSize()):s.call(this,this._contextSize)}function a(){for(var t=null,e=this._position,i=[],n=-this._positionOffset,a=o.call(this),h=this._node;h&&n-e<a+this.options.margin;)n+=r.call(this,h,n,i),h=h.getNext?h.getNext():null;var c=this._node,u=s.call(this,c.getSize());if(a>n){for(;c&&a>u;)c=c.getPrevious(),c&&(u+=s.call(this,c.getSize()));for(c=this._node;c&&a>u;)c=c.getNext(),c&&(u+=s.call(this,c.getSize()))}for(!h&&a-g>n-e?1!==this._onEdge&&(this._onEdge=1,this._eventOutput.emit("onEdge",{position:n-a})):!this._node.getPrevious()&&-g>e?-1!==this._onEdge&&(this._onEdge=-1,this._eventOutput.emit("onEdge",{position:0})):0!==this._onEdge&&(this._onEdge=0,this._eventOutput.emit("offEdge")),h=this._node&&this._node.getPrevious?this._node.getPrevious():null,n=-this._positionOffset,h&&(t=h.getSize?h.getSize():this._contextSize,n-=s.call(this,t));h&&n-e>-(a+this.options.margin);)r.call(this,h,n,i),h=h.getPrevious?h.getPrevious():null,h&&(t=h.getSize?h.getSize():this._contextSize,n-=s.call(this,t));return i}var h=t("../core/Entity"),c=t("../core/Group"),u=t("../core/OptionsManager"),p=t("../core/Transform"),l=t("../utilities/Utility"),d=t("../core/ViewSequence"),f=t("../core/EventHandler");n.DEFAULT_OPTIONS={direction:l.Direction.Y,margin:0,clipSize:void 0,groupScroll:!1};var g=0;n.prototype.getCumulativeSize=function(t){return void 0===t&&(t=this._node._.cumulativeSizes.length-1),this._node._.getSize(t)},n.prototype.setOptions=function(t){t.groupScroll!==this.options.groupScroll&&(t.groupScroll?this.group.pipe(this._eventOutput):this.group.unpipe(this._eventOutput)),this._optionsManager.setOptions(t)},n.prototype.onEdge=function(){return this._onEdge},n.prototype.outputFrom=function(t,e){t||(t=function(t){return this.options.direction===l.Direction.X?p.translate(t,0):p.translate(0,t)}.bind(this),e||(e=t)),this._outputFunction=t,this._masterOutputFunction=e?e:function(e){return p.inverse(t(-e))}},n.prototype.positionFrom=function(t){t instanceof Function?this._positionGetter=t:t&&t.get?this._positionGetter=t.get.bind(t):(this._positionGetter=null,this._position=t),this._positionGetter&&(this._position=this._positionGetter.call(this))},n.prototype.sequenceFrom=function(t){t instanceof Array&&(t=new d({array:t})),this._node=t,this._positionOffset=0},n.prototype.getSize=function(t){return t?this._contextSize:this._size},n.prototype.render=function(){return this._node?(this._positionGetter&&(this._position=this._positionGetter.call(this)),this._entityId):null},n.prototype.commit=function(t){var e=t.transform,i=t.opacity,n=t.origin,s=t.size;this.options.clipSize||s[0]===this._contextSize[0]&&s[1]===this._contextSize[1]||(this._onEdge=0,this._contextSize[0]=s[0],this._contextSize[1]=s[1],this.options.direction===l.Direction.X?(this._size[0]=o.call(this),this._size[1]=void 0):(this._size[0]=void 0,this._size[1]=o.call(this)));
var r=this._masterOutputFunction(-this._position);return{transform:p.multiply(e,r),size:s,opacity:i,origin:n,target:this.group.render()}},i.exports=n}),define(function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new b(this.options),this._scroller=new x(this.options),this.sync=new w(["scroll","touch"],{direction:this.options.direction,scale:this.options.syncScale,rails:this.options.rails,preventDefault:void 0!==this.options.preventDefault?this.options.preventDefault:this.options.direction!==z.Direction.Y}),this._physicsEngine=new _,this._particle=new m,this._physicsEngine.addBody(this._particle),this.spring=new v({anchor:[0,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),this.drag=new y({forceFunction:y.FORCE_FUNCTIONS.QUADRATIC,strength:this.options.drag}),this.friction=new y({forceFunction:y.FORCE_FUNCTIONS.LINEAR,strength:this.options.friction}),this._node=null,this._touchCount=0,this._springState=M.NONE,this._onEdge=P.NONE,this._pageSpringPosition=0,this._edgeSpringPosition=0,this._touchVelocity=0,this._earlyEnd=!1,this._needsPaginationCheck=!1,this._displacement=0,this._totalShift=0,this._cachedIndex=0,this._scroller.positionFrom(this.getPosition.bind(this)),this._eventInput=new O,this._eventOutput=new O,this._eventInput.pipe(this.sync),this.sync.pipe(this._eventInput),O.setInputHandler(this,this._eventInput),O.setOutputHandler(this,this._eventOutput),a.call(this),t&&this.setOptions(t)}function s(t){this._touchCount=t.count,void 0===t.count&&(this._touchCount=1),c.call(this),this.setVelocity(0),this._touchVelocity=0,this._earlyEnd=!1}function r(t){var e=-t.velocity,i=-t.delta;if(this._onEdge!==P.NONE&&t.slip&&(0>e&&this._onEdge===P.TOP||e>0&&this._onEdge===P.BOTTOM?this._earlyEnd||(o.call(this,t),this._earlyEnd=!0):this._earlyEnd&&Math.abs(e)>Math.abs(this.getVelocity())&&s.call(this,t)),!this._earlyEnd){if(this._touchVelocity=e,t.slip){var n=this.options.speedLimit;-n>e?e=-n:e>n&&(e=n),this.setVelocity(e);var r=16*n;i>r?i=r:-r>i&&(i=-r)}this.setPosition(this.getPosition()+i),this._displacement+=i,this._springState===M.NONE&&f.call(this)}}function o(t){if(this._touchCount=t.count||0,!this._touchCount){c.call(this),this._onEdge!==P.NONE&&d.call(this,this._edgeSpringPosition,M.EDGE),h.call(this);var e=-t.velocity,i=this.options.speedLimit;t.slip&&(i*=this.options.edgeGrip),-i>e?e=-i:e>i&&(e=i),this.setVelocity(e),this._touchVelocity=0,this._needsPaginationCheck=!0}}function a(){this._eventInput.bindThis(this),this._eventInput.on("start",s),this._eventInput.on("update",r),this._eventInput.on("end",o),this._eventInput.on("resize",function(){this._node._.calculateSize()}.bind(this)),this._scroller.on("onEdge",function(t){this._edgeSpringPosition=t.position,p.call(this,this._scroller.onEdge()),this._eventOutput.emit("onEdge")}.bind(this)),this._scroller.on("offEdge",function(){this.sync.setOptions({scale:this.options.syncScale}),this._onEdge=this._scroller.onEdge(),this._eventOutput.emit("offEdge")}.bind(this)),this._particle.on("update",function(t){this._springState===M.NONE&&f.call(this),this._displacement=t.position.x-this._totalShift}.bind(this)),this._particle.on("end",function(){(!this.options.paginated||this.options.paginated&&this._springState!==M.NONE)&&this._eventOutput.emit("settle")}.bind(this))}function h(){this._springState?this._physicsEngine.attach([this.spring],this._particle):this._physicsEngine.attach([this.drag,this.friction],this._particle)}function c(){this._springState=M.NONE,this._physicsEngine.detachAll()}function u(t){var e=this.options.direction,i=t.getSize();return i?i[e]:this._scroller.getSize()[e]}function p(t){this.sync.setOptions({scale:this.options.edgeGrip}),this._onEdge=t,this._touchCount||this._springState===M.EDGE||d.call(this,this._edgeSpringPosition,M.EDGE),this._springState&&Math.abs(this.getVelocity())<.001&&(c.call(this),h.call(this))}function l(){if(!this._touchCount&&this._springState!==M.EDGE){var t=this.getVelocity();if(!(Math.abs(t)>=this.options.pageStopSpeed)){var e=this.getPosition(),i=Math.abs(t)>this.options.pageSwitchSpeed,n=u.call(this,this._node),s=e>.5*n,r=t>0,o=0>t;this._needsPaginationCheck=!1,s&&!i||i&&r?this.goToNextPage():i&&o?this.goToPreviousPage():d.call(this,0,M.PAGE)}}}function d(t,e){var i;e===M.EDGE?(this._edgeSpringPosition=t,i={anchor:[this._edgeSpringPosition,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}):e===M.PAGE&&(this._pageSpringPosition=t,i={anchor:[this._pageSpringPosition,0,0],period:this.options.pagePeriod,dampingRatio:this.options.pageDamp}),this.spring.setOptions(i),e&&!this._springState&&(c.call(this),this._springState=e,h.call(this)),this._springState=e}function f(){var t=0,e=this.getPosition();e+=(0>e?-.5:.5)>>0;for(var i=u.call(this,this._node),n=this._node.getNext();t+e>=i&&n;)t-=i,this._scroller.sequenceFrom(n),this._node=n,n=this._node.getNext(),i=u.call(this,this._node);for(var s,r=this._node.getPrevious();0>=t+e&&r;)s=u.call(this,r),this._scroller.sequenceFrom(r),this._node=r,t+=s,r=this._node.getPrevious();t&&g.call(this,t),this._node&&(this._node.index!==this._cachedIndex?this.getPosition()<.5*i&&(this._cachedIndex=this._node.index,this._eventOutput.emit("pageChange",{direction:-1,index:this._cachedIndex})):this.getPosition()>.5*i&&(this._cachedIndex=this._node.index+1,this._eventOutput.emit("pageChange",{direction:1,index:this._cachedIndex})))}function g(t){this._edgeSpringPosition+=t,this._pageSpringPosition+=t,this.setPosition(this.getPosition()+t),this._totalShift+=t,this._springState===M.EDGE?this.spring.setOptions({anchor:[this._edgeSpringPosition,0,0]}):this._springState===M.PAGE&&this.spring.setOptions({anchor:[this._pageSpringPosition,0,0]})}var _=t("../physics/PhysicsEngine"),m=t("../physics/bodies/Particle"),y=t("../physics/forces/Drag"),v=t("../physics/forces/Spring"),O=t("../core/EventHandler"),b=t("../core/OptionsManager"),S=t("../core/ViewSequence"),x=t("../views/Scroller"),z=t("../utilities/Utility"),w=t("../inputs/GenericSync"),E=t("../inputs/ScrollSync"),T=t("../inputs/TouchSync");w.register({scroll:E,touch:T});var M={NONE:0,EDGE:1,PAGE:2},P={TOP:-1,NONE:0,BOTTOM:1};n.DEFAULT_OPTIONS={direction:z.Direction.Y,rails:!0,friction:.005,drag:1e-4,edgeGrip:.2,edgePeriod:300,edgeDamp:1,margin:1e3,paginated:!1,pagePeriod:500,pageDamp:.8,pageStopSpeed:10,pageSwitchSpeed:.5,speedLimit:5,groupScroll:!1,syncScale:1},n.prototype.getCurrentIndex=function(){return this._node.index},n.prototype.goToPreviousPage=function(){if(!this._node||this._onEdge===P.TOP)return null;if(this.getPosition()>1&&this._springState===M.NONE)return d.call(this,0,M.PAGE),this._node;var t=this._node.getPrevious();if(t){var e=u.call(this,t);this._scroller.sequenceFrom(t),this._node=t,g.call(this,e),d.call(this,0,M.PAGE)}return t},n.prototype.goToNextPage=function(){if(!this._node||this._onEdge===P.BOTTOM)return null;var t=this._node.getNext();if(t){var e=u.call(this,this._node);this._scroller.sequenceFrom(t),this._node=t,g.call(this,-e),d.call(this,0,M.PAGE)}return t},n.prototype.goToPage=function(t){var e,i=this.getCurrentIndex();if(i>t)for(e=0;i-t>e;e++)this.goToPreviousPage();if(t>i)for(e=0;t-i>e;e++)this.goToNextPage()},n.prototype.outputFrom=function(){return this._scroller.outputFrom.apply(this._scroller,arguments)},n.prototype.getPosition=function(){return this._particle.getPosition1D()},n.prototype.getAbsolutePosition=function(){return this._scroller.getCumulativeSize(this.getCurrentIndex())[this.options.direction]+this.getPosition()},n.prototype.getOffset=n.prototype.getPosition,n.prototype.setPosition=function(t){this._particle.setPosition1D(t)},n.prototype.setOffset=n.prototype.setPosition,n.prototype.getVelocity=function(){return this._touchCount?this._touchVelocity:this._particle.getVelocity1D()},n.prototype.setVelocity=function(t){this._particle.setVelocity1D(t)},n.prototype.setOptions=function(t){void 0!==t.direction&&("x"===t.direction?t.direction=z.Direction.X:"y"===t.direction&&(t.direction=z.Direction.Y)),t.groupScroll!==this.options.groupScroll&&(t.groupScroll?this.subscribe(this._scroller):this.unsubscribe(this._scroller)),this._optionsManager.setOptions(t),this._scroller.setOptions(t),void 0!==t.drag&&this.drag.setOptions({strength:this.options.drag}),void 0!==t.friction&&this.friction.setOptions({strength:this.options.friction}),(void 0!==t.edgePeriod||void 0!==t.edgeDamp)&&this.spring.setOptions({period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),(t.rails||void 0!==t.direction||void 0!==t.syncScale||t.preventDefault)&&this.sync.setOptions({rails:this.options.rails,direction:this.options.direction===z.Direction.X?w.DIRECTION_X:w.DIRECTION_Y,scale:this.options.syncScale,preventDefault:this.options.preventDefault})},n.prototype.sequenceFrom=function(t){return t instanceof Array&&(t=new S({array:t,trackSize:!0})),this._node=t,this._scroller.sequenceFrom(t)},n.prototype.getSize=function(){return this._scroller.getSize.apply(this._scroller,arguments)},n.prototype.render=function(){return this.options.paginated&&this._needsPaginationCheck&&l.call(this),this._scroller.render()},i.exports=n}),define(function(t,e,i){function n(t){this._items=null,this._size=null,this._outputFunction=n.DEFAULT_OUTPUT_FUNCTION,this.options=h.clone(this.constructor.DEFAULT_OPTIONS||n.DEFAULT_OPTIONS),this.optionsManager=new s(this.options),this.id=r.register(this),this.cachedSize=[void 0,void 0],t&&this.setOptions(t)}var s=t("../core/OptionsManager"),r=t("../core/Entity"),o=t("../core/Transform"),a=t("../core/ViewSequence"),h=t("../utilities/Utility");n.DEFAULT_OPTIONS={direction:h.Direction.Y,itemSpacing:0},n.DEFAULT_OUTPUT_FUNCTION=function(t,e){var i=this.options.direction===h.Direction.X?o.translate(e,0):o.translate(0,e);return{size:this.cachedSize,transform:i,target:t.render()}},n.prototype.getSize=function(){return this._size||this.render(),this._size},n.prototype.sequenceFrom=function(t){return t instanceof Array&&(t=new a(t)),this._items=t,this},n.prototype.setOptions=function(){return this.optionsManager.setOptions.apply(this.optionsManager,arguments),this},n.prototype.setOutputFunction=function(t){return this._outputFunction=t,this},n.prototype.render=function(){return this.id},n.prototype.commit=function(t){var e=0,i=1^this.options.direction,n=this._items,s=null,r=[],o={},a=[],h=0;for(this._size=[0,0],this.cachedSize=t.size;n&&(s=n.get());)s.getSize&&(r=s.getSize()),o=this._outputFunction.call(this,s,e,h++),a.push(o),r&&(r[this.options.direction]&&(e+=r[this.options.direction]),r[i]>this._size[i]&&(this._size[i]=r[i]),0===r[i]&&(this._size[i]=void 0)),n=n.getNext(),this.options.itemSpacing&&n&&(e+=this.options.itemSpacing);return this._size[this.options.direction]=e,{transform:t.transform,origin:t.origin,opacity:t.opacity,size:this.getSize(),target:a}},i.exports=n}),define(function(t,e,i){function n(){s.apply(this,arguments),this._id=r.register(this),this._parentSize=[]}var s=t("../core/View"),r=t("../core/Entity"),o=t("../core/Transform");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.commit=function(t){var e=t.transform,i=t.opacity,n=t.origin;return this._parentSize&&this._parentSize[0]===t.size[0]&&this._parentSize[1]===t.size[1]||(this._parentSize[0]=t.size[0],this._parentSize[1]=t.size[1],this._eventInput.emit("parentResize",this._parentSize),this.onResize&&this.onResize(this._parentSize)),this._parentSize&&(e=o.moveThen([-this._parentSize[0]*n[0],-this._parentSize[1]*n[1],0],e)),{transform:e,opacity:i,size:this._parentSize,target:this._node.render()}},n.prototype.getParentSize=function(){return this._parentSize},n.prototype.render=function(){return this._id},i.exports=n});